<!DOCTYPE html>
<html lang="en" dir="ltr" class="spectrum spectrum--medium spectrum--lightest">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>Writing Testable Code | Archived 2.3 Magento Developer Guide</title>
	<meta name="description" content="Magento Developer Guide">

	<link rel="stylesheet" href="https://use.typekit.net/iaw1apr.css">
	<link rel="stylesheet" href="/devdocs-archive/2.3/assets/css/app.css?ver=20" />
	<link rel="stylesheet" href="/devdocs-archive/2.3/assets/css/print.css?ver=20" media="print" />
	<script src="https://assets.adobedtm.com/a7d65461e54e/f87b70cb627a/launch-b042bff6c581.min.js" async></script>

	<link rel="stylesheet" href="/devdocs-archive/2.3/common/css/devdocs.css" />
<link rel="alternate" type="application/rss+xml" title="Magento DevDocs RSS" href="/feed.xml" />
<meta name="google-site-verification" content="3WFsoYwBe6UuxDwgs7bmd7t0YFQVzDpLpWLjNh0CUp8" />

	<script>
  var baseUrl = "/devdocs-archive/2.3";
  var algolia = {
    id: "E642SEDTHL",
    index: "devdocs",
    key: "d2d0f33ab73e291ef8d88d8b565e754c",
  };

  var indices = [{
      label: "Results",
      name: "devdocs",
      facetFilters: [
        ["guide_version: 2.3",
          "versionless: true"
        ]
      ],
      refinements: [{
        label: "Functional areas",
        attribute: "functional_areas"
      }],
      baseUrl: "/devdocs-archive/2.3"
    }
  ];

</script>




	<link rel="icon" href="https://www.adobe.com/favicon.ico" type="image/x-icon" />
	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://adobe.com/favicon.ico">

</head>

<body class="layout-default">

	<header class="site-header">

		

<nav class="site-nav">

  <div class="nav-container">

    <div class="menu-btn">
      <button id="menu-btn" class="menu-trigger menu-icon" aria-haspopup="true" aria-controls="nav-main" aria-label="Menu"></button>
    </div>

    <a class="logo" href="/devdocs-archive/2.3/">
      <img class="logo-image" src="/devdocs-archive/2.3/assets/i/adobe-a.svg" alt="Adobe">
      <span class="logo-text">Adobe</span>
      <span class="site-logo">Commerce DevDocs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      <!-- Main Navigation --><ul class="nav-main spectrum-Tabs spectrum-Tabs--sizeM spectrum-Tabs--horizontal" role="menubar"><li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Cloud</span><div class="nav-popup spectrum-Popover"><div class="nav-section">
              <div class="spectrum-Menu-sectionHeading">Cloud basics</div>
              <ul class="spectrum-Menu"><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/overview.html" class="spectrum-Menu-itemLabel ">Cloud Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/architecture/cloud-architecture.html" class="spectrum-Menu-itemLabel ">Cloud Architecture</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/project/file-structure.html" class="spectrum-Menu-itemLabel ">Project Structure</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/best-practices.html" class="spectrum-Menu-itemLabel ">Upgrades and Patches</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/release-notes/cloud-tools-suite.html" class="spectrum-Menu-itemLabel ">Release Notes</a></li></ul>
            </div><div class="nav-section">
              <div class="spectrum-Menu-sectionHeading">Cloud development</div>
              <ul class="spectrum-Menu"><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/cloud-tools/docker/" class="spectrum-Menu-itemLabel ">Local development</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/cloud-tools/docker/configure/" class="spectrum-Menu-itemLabel ">Configure and launch Docker</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/cloud-tools/docker/quick-reference/" class="spectrum-Menu-itemLabel ">Docker quick reference</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/configure/app/configure-app-yaml.html" class="spectrum-Menu-itemLabel ">Configure Application</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/configure/env/configure-env-yaml.html" class="spectrum-Menu-itemLabel ">Configure Environments</a></li></ul>
            </div><div class="nav-section">
              <div class="spectrum-Menu-sectionHeading">Functional Testing</div>
              <ul class="spectrum-Menu"><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/cloud-tools/docker/test/application-testing/" class="spectrum-Menu-itemLabel ">Application testing</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/cloud-tools/docker/test/code-testing/" class="spectrum-Menu-itemLabel ">Cloud code testing</a></li></ul>
            </div></div></li><li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Setup</span><div class="nav-popup spectrum-Popover"><ul><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/install-gde/install-flow-diagram.html" class="spectrum-Menu-itemLabel ">Installation Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-admin/start/resources/extensions.html" class="spectrum-Menu-itemLabel ">Extensions Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/comp-mgr/bk-compman-upgrade-guide.html" class="spectrum-Menu-itemLabel ">Software Update Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/config-guide/bk-config-guide.html" class="spectrum-Menu-itemLabel ">Configuration Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/performance-best-practices/introduction.html" class="spectrum-Menu-itemLabel ">Performance Best Practices</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/migration/bk-migration-guide.html" class="spectrum-Menu-itemLabel ">Migration Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-operations/release/notes/overview.html" class="spectrum-Menu-itemLabel ">Release Information</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/reference/cli/magento.html" class="spectrum-Menu-itemLabel ">Command-line Tools Reference</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-operations/tools/overview.html" class="spectrum-Menu-itemLabel ">Tools</a></li></ul></div></li><li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Development</span><div class="nav-popup spectrum-Popover"><div class="nav-section">
              <div class="spectrum-Menu-sectionHeading">Backend</div>
              <ul class="spectrum-Menu"><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/architecture/bk-architecture.html" class="spectrum-Menu-itemLabel ">Architecture</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/extension-dev-guide/bk-extension-dev-guide.html" class="spectrum-Menu-itemLabel ">PHP Developer Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/ext-best-practices/bk-ext-best-practices.html" class="spectrum-Menu-itemLabel ">Extension Developer Best Practices</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/mrg/intro.html" class="spectrum-Menu-itemLabel ">Module Reference Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/coding-standards/bk-coding-standards.html" class="spectrum-Menu-itemLabel ">Coding Standards</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/contributor/guides/" class="spectrum-Menu-itemLabel ">Contributor Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/contributor/community/" class="spectrum-Menu-itemLabel ">Contribution Resources</a></li></ul>
            </div><div class="nav-section">
              <div class="spectrum-Menu-sectionHeading">Frontend</div>
              <ul class="spectrum-Menu"><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/frontend-dev-guide/bk-frontend-dev-guide.html" class="spectrum-Menu-itemLabel ">Frontend Developer Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/ui_comp_guide/bk-ui_comps.html" class="spectrum-Menu-itemLabel ">UI Components Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/javascript-dev-guide/bk-javascript-dev-guide.html" class="spectrum-Menu-itemLabel ">JavaScript Developer Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/pattern-library/bk-pattern.html" class="spectrum-Menu-itemLabel ">Admin Design Pattern Library</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/design-styleguide/bk-styleguide.html" class="spectrum-Menu-itemLabel ">Admin Style Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/pwa-studio/" class="spectrum-Menu-itemLabel ">PWA Documentation Site</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/frontend-core/page-builder/" class="spectrum-Menu-itemLabel ">Page Builder Developer Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="spectrum-Menu-sectionHeading">API</div>
              <ul class="spectrum-Menu"><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/get-started/bk-get-started-api.html" class="spectrum-Menu-itemLabel ">Get Started with our Web APIs</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/rest/bk-rest.html" class="spectrum-Menu-itemLabel ">REST API Reference</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/soap/bk-soap.html" class="spectrum-Menu-itemLabel ">SOAP API Reference</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/graphql/" class="spectrum-Menu-itemLabel ">GraphQL Developer Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/marketplace/guides/eqp/v1/" class="spectrum-Menu-itemLabel ">Marketplace EQP API Reference</a></li></ul>
            </div></div></li><li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Testing</span><div class="nav-popup spectrum-Popover"><ul><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/testing.html" class="spectrum-Menu-itemLabel ">Application Testing Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/mftf/v2/docs/introduction.html" class="spectrum-Menu-itemLabel ">Functional Acceptance Testing (MFTF)</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/integration/integration_test_execution.html" class="spectrum-Menu-itemLabel ">Integration Testing</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/js/jasmine.html" class="spectrum-Menu-itemLabel ">JavaScript Unit Testing</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/unit/unit_test_execution.html" class="spectrum-Menu-itemLabel ">PHP Unit Testing</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/get-started/web-api-functional-testing.html" class="spectrum-Menu-itemLabel ">Web API Functional Testing</a></li></ul></div></li><li class="nav-main-separator"></li><li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Functional Areas</span><div class="nav-popup spectrum-Popover"><ul><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/advanced-reporting/overview.html" class="spectrum-Menu-itemLabel ">Advanced Reporting</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/b2b/bk-b2b.html" class="spectrum-Menu-itemLabel ">B2B</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-merchant-services/catalog-service/overview.html" class="spectrum-Menu-itemLabel ">Catalog Service</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/howdoi/checkout/checkout_overview.html" class="spectrum-Menu-itemLabel ">Checkout</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/inventory/index.html" class="spectrum-Menu-itemLabel ">Inventory Management</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-merchant-services/live-search/guide-overview.html" class="spectrum-Menu-itemLabel ">Live Search</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/marketplace/guides/sellers/" class="spectrum-Menu-itemLabel ">Commerce Marketplace</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-merchant-services/payment-services/guide-overview.html" class="spectrum-Menu-itemLabel ">Payment Services</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://omsdocs.magento.com/en/" class="spectrum-Menu-itemLabel ">Order Management</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/frontend-core/page-builder/" class="spectrum-Menu-itemLabel ">Page Builder</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-merchant-services/product-recommendations/developer/development-overview.html" class="spectrum-Menu-itemLabel ">Product Recommendations Developer Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-operations/security-and-compliance/overview.html" class="spectrum-Menu-itemLabel ">Security and Compliance</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/services/shared-services/" class="spectrum-Menu-itemLabel ">Shared Services</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/extension-dev-guide/staging.html" class="spectrum-Menu-itemLabel ">Staging</a></li></ul></div></li><li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Tutorials</span><div class="nav-popup spectrum-Popover"><ul><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/rest/tutorials/index.html" class="spectrum-Menu-itemLabel ">Rest Tutorials</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/howdoi/custom-attributes/introduction.html" class="spectrum-Menu-itemLabel ">Custom Attributes</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/howdoi/customize_product.html" class="spectrum-Menu-itemLabel ">Customize Product Creation Form</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/howdoi/checkout/checkout_overview.html" class="spectrum-Menu-itemLabel ">Customize Checkout</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://developer.adobe.com/commerce/contributor/community/support/" class="spectrum-Menu-itemLabel ">Support</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://experienceleague.adobe.com/docs/commerce-learn/tutorials/overview.html" class="spectrum-Menu-itemLabel ">Video Tutorials</a></li></ul></div></li></ul><!-- /.nav-main -->

    </div>

    <div class="nav-actions">
      <div class="version-switcher">
	<button class="spectrum-Picker spectrum-Picker--sizeM dropdown-toggle" disabled>
		<span class="spectrum-Picker-label">Version 2.3</span>
	</button>
</div>
    </div>

  </div>

</nav><!-- #site-nav -->
<div class="nav-main-fader"></div>


	</header>

	<div class="global-wrapper">

		

		<div class="main-container">
			<a id="main-content"></a>

<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
	<button class="toc-toggler">Table of Contents</button>
	<div class="sidebar-wrapper">

		

		<h4 class="guide-title">Testing</h4>
		
		<div class="collapsible-navigation">
		  <ul class="spectrum-SideNav spectrum-SideNav--multiLevel"><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/testing.html" class="spectrum-SideNav-itemLink ">Introduction</a></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">Integration testing</span><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/integration/integration_test_execution.html" class="spectrum-SideNav-itemLink ">Running integration tests</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/integration/annotations.html" class="spectrum-SideNav-itemLink ">Using DocBlock annotations</a><ul class=""><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/integration/annotations/depends.html" class="spectrum-SideNav-itemLink ">@depends</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/integration/annotations/magento-app-area.html" class="spectrum-SideNav-itemLink ">@magentoAppArea</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/integration/annotations/magento-app-isolation.html" class="spectrum-SideNav-itemLink ">@magentoAppIsolation</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/integration/annotations/magento-cache.html" class="spectrum-SideNav-itemLink ">@magentoCache</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/integration/annotations/magento-components-dir.html" class="spectrum-SideNav-itemLink ">@magentoComponentsDir</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/integration/annotations/magento-config-fixture.html" class="spectrum-SideNav-itemLink ">@magentoConfigFixture</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/integration/annotations/magento-data-fixture.html" class="spectrum-SideNav-itemLink ">@magentoDataFixture</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/integration/annotations/magento-db-isolation.html" class="spectrum-SideNav-itemLink ">@magentoDbIsolation</a></li></ul></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">JavaScript Unit Testing</span><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/js/jasmine.html" class="spectrum-SideNav-itemLink ">Jasmine</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">PHP Unit Testing</span><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/unit/unit_test_execution.html" class="spectrum-SideNav-itemLink ">Running Unit Tests</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/unit/unit_test_execution_cli.html" class="spectrum-SideNav-itemLink ">Running Unit Tests in CLI</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/unit/unit_test_execution_phpstorm.html" class="spectrum-SideNav-itemLink ">Running Unit Tests in PhpStorm</a></li><li class="is-selected  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/unit/writing_testable_code.html" class="spectrum-SideNav-itemLink ">Writing Testable Code</a></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">Using DocBlock annotations</span><ul class=""><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/unit/annotations/data-provider.html" class="spectrum-SideNav-itemLink ">@dataProvider</a></li></ul></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">Static Testing</span><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/static/static_test_execution.html" class="spectrum-SideNav-itemLink ">Running Static Tests</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/static/static-analysis.html" class="spectrum-SideNav-itemLink ">Setting up for Static Analysis</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">Semantic Version Checker</span><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/test/svc/semver_test_execution.html" class="spectrum-SideNav-itemLink ">Running SVC tool</a></li></ul></li></ul>
		</div>

	</div>

</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<header class="content-header">
				<!-- page-header -->
<section class="page-intro">

  

  
  <div class="message-banner">
    <center>Adobe Commerce 2.3 reached end of support in September 2022.</center>
  </div>
  

  




<!--   

<div class="spectrum-Tags" role="list" aria-label="Tags">
  <div class="spectrum-Tags-item" role="listitem" tabindex="0">
    <img class="spectrum-Avatar" src="img/example-ava.jpg" alt="Avatar">
    <span class="spectrum-Tags-itemLabel">Shantanu</span>
  </div>
</div> -->


  <h1 class="page-title">Writing Testable Code</h1>

  

  
	<div class="github-links spectrum-ActionGroup--compact ActionGroup--justified"></div>
	

</section>

			</header>
			<main>
				<p>This topic does not aim to be a replacement for existing documentation about testing, but rather tries to highlight some thoughts on the subject. Although the truth of anything depends somewhat on the context, this topic attempts to provide information that is applicable in <em>most</em> situations.</p>

<h2 id="tests-should-be-simple">Tests should be simple</h2>

<p>Tests should be trivial to write. Simple, small classes with few collaborators are easy to test. If testing a class is difficult, the class probably has grown too large and does too much. Split the class into several classes, each of which does only one thing.</p>

<h2 id="manage-dependencies">Manage dependencies</h2>

<p>A big part of making code testable is managing its dependencies. Dependencies can take many forms and they can be clearly stated or hidden.</p>

<p>The fewer dependencies a class has and the more obvious they are, the easier it is to maintain and test the class. At the same time, the class is less likely to break because of future changes.</p>

<h3 id="creating-new-instances">Creating new instances</h3>

<p>We strongly recommend you do <em>not</em>:</p>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">new</code> to instantiate new objects, because that removes the flexibility the Magento dependency configuration offers.</li>
  <li>Use the <code class="language-plaintext highlighter-rouge">ObjectManager</code> directly in production code.</li>
</ul>

<p>There always is a better alternative, usually a <a href="/devdocs-archive/2.3/guides/v2.3/extension-dev-guide/code-generation.html">generated</a> <code class="language-plaintext highlighter-rouge">Factory</code> class, or a <a href="https://thephp.cc/news/2015/09/dependencies-in-disguise"><code class="language-plaintext highlighter-rouge">Locator</code></a> class of sorts.</p>

<p class="bs-callout-info">This rule applies only to production code. When writing <a href="/devdocs-archive/2.3/guides/v2.3/test/integration/integration_test_execution.html">integration tests</a>, this is not true. In fact, the object manager is recommended for integration tests.</p>

<h3 id="collaborator-classes">Collaborator classes</h3>

<p>Whenever an external class property, class constant, or a class method is used in a file, this file depends on the class containing the method or constant. Even if the external class is not used as a instantiated object, the current class is still hard-wired to depend on it.</p>

<p><a href="https://glossary.magento.com/php">PHP</a> cannot execute the code unless it can load the external class, too. That is why such external classes are referred to as <em>dependencies</em>. Try to keep the number dependencies of to a minimum.</p>

<p>Collaborator instances should be passed into the class using <a href="/devdocs-archive/2.3/guides/v2.3/extension-dev-guide/depend-inj.html#constructor-injection">constructor injection</a>.</p>

<h3 id="the-environment-file-system-time-global-variables">The environment (file system, time, global variables)</h3>

<p>Whenever your code requires access to some part of the environment, try to use a collaborator class that can easily be replaced by a test double (also referred to as a <em>mock</em>) instead.</p>

<p>For example, if you need…</p>

<ul>
  <li>file system access?</li>
</ul>

<p>Use <a href="https://github.com/magento/magento2/blob/2.3/lib/internal/Magento/Framework/Filesystem/Io/IoInterface.php"><code class="language-plaintext highlighter-rouge">\Magento\Framework\Filesystem\Io\IoInterface</code></a> instead of <code class="language-plaintext highlighter-rouge">fopen()</code>, <code class="language-plaintext highlighter-rouge">dir()</code> or other native methods.</p>

<ul>
  <li>
    <p>the current time?</p>

    <p>Inject a <a href="https://www.php.net/manual/en/refs.calendar.php"><code class="language-plaintext highlighter-rouge">\DateTimeInterface</code></a> instance (for example <code class="language-plaintext highlighter-rouge">\DateTimeImmutable</code>) and use that.</p>
  </li>
  <li>
    <p>the remote IP?</p>
  </li>
</ul>

<p>Use <a href="https://github.com/magento/magento2/blob/2.3/lib/internal/Magento/Framework/HTTP/PhpEnvironment/RemoteAddress.php"><code class="language-plaintext highlighter-rouge">\Magento\Framework\HTTP\PhpEnvironment\RemoteAddress</code></a>.</p>

<ul>
  <li>access to <code class="language-plaintext highlighter-rouge">$_SERVER</code>?</li>
</ul>

<p>Consider using <a href="https://github.com/magento/magento2/blob/2.3/lib/internal/Magento/Framework/HTTP/PhpEnvironment/Request.php"><code class="language-plaintext highlighter-rouge">\Magento\Framework\HTTP\PhpEnvironment\Request::getServerValue()</code></a>.</p>

<p>Anything that can be easily replaced by a test double is preferable to using low level functions.</p>

<h2 id="interfaces-over-classes">Interfaces over classes</h2>

<p>Dependencies on <em>interfaces</em> should be preferred over dependencies on <em>classes</em> because the former decouples your code from implementation details. This helps to isolate your code from future changes.</p>

<p>This guideline is true only if you exclusively use the methods and constants defined in the interface. If your code also uses other public methods specific to the class implementing the interface, your code is no longer independent of the implementation details.</p>

<p>You lose any benefits of having an interface if you use methods of a concrete class.</p>

<p>Even worse, the code is lying, because apparently there is a dependency on the interface only; however, you could not use a different implementation of the same interface. This can lead to considerable maintenance costs down the road. In such cases, using the class name of the concrete implementation is preferable to using the interface name as a dependency.</p>

<p>To illustrate, assume there is a theoretical <code class="language-plaintext highlighter-rouge">RequestInterface</code> with two methods, <code class="language-plaintext highlighter-rouge">getPathInfo()</code> and <code class="language-plaintext highlighter-rouge">getParam($name)</code>.</p>

<p>For example:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kd">interface</span> <span class="nc">RequestInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">getPathInfo</span><span class="p">();</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">getParam</span><span class="p">(</span><span class="nv">$name</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Assume there is a concrete implementation <code class="language-plaintext highlighter-rouge">HttpRequest</code> that also has a public method <code class="language-plaintext highlighter-rouge">getParams()</code> in addition to the two interface methods.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">HttpRequest</span> <span class="kd">implements</span> <span class="nc">RequestInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">getPathInfo</span><span class="p">()</span> <span class="p">{</span><span class="mf">...</span><span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">getParam</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span><span class="mf">...</span><span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">getParams</span><span class="p">()</span> <span class="p">{</span><span class="mf">...</span><span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Any code that depends on <code class="language-plaintext highlighter-rouge">RequestInterface</code> should avoid using the <code class="language-plaintext highlighter-rouge">getParams()</code> method, because it is not part of the interface.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">MyClass</span>
<span class="p">{</span>
    <span class="cd">/**
     * @var RequestInterface
     */</span>
    <span class="k">private</span> <span class="nv">$request</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="kt">RequestInterface</span> <span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">request</span> <span class="o">=</span> <span class="nv">$request</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">doSomething</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">request</span><span class="o">-&gt;</span><span class="nf">getParams</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$paramName</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// ... some more code</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This completely defeats the purpose of the interface. A better solution might be the following:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">function</span> <span class="n">doSomething</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">foreach</span> <span class="p">([</span><span class="s1">'foo'</span><span class="p">,</span> <span class="s1">'bar'</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$paramName</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$value</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">request</span><span class="o">-&gt;</span><span class="nf">getParam</span><span class="p">(</span><span class="nv">$paramName</span><span class="p">);</span>
        <span class="c1">// ... some more code</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The second example method <code class="language-plaintext highlighter-rouge">doSomething()</code> does not call the <code class="language-plaintext highlighter-rouge">getParams()</code> method.</p>

<p>If <code class="language-plaintext highlighter-rouge">getParams()</code> had been called, the class <code class="language-plaintext highlighter-rouge">MyClass</code> would have instantly depended on the <code class="language-plaintext highlighter-rouge">HttpRequest</code> implementation and the benefit of having an interface would have been completely lost.</p>

<p>If cannot avoid using <code class="language-plaintext highlighter-rouge">getParams()</code>, you can do any of the following:</p>

<ul>
  <li>Add the <code class="language-plaintext highlighter-rouge">getParams()</code> method to <code class="language-plaintext highlighter-rouge">RequestInterface</code></li>
  <li>Make <code class="language-plaintext highlighter-rouge">MyClass</code> dependent on <code class="language-plaintext highlighter-rouge">HttpRequest</code> directly instead of using <code class="language-plaintext highlighter-rouge">RequestInterface</code> as a constructor argument</li>
</ul>

<p>The benefit <em>interfaces</em> offer is that interfaces keep code decoupled from implementation details. This means that future changes will not cause your code to fail unless the interface is changed too.</p>

<p>Also, interfaces can very easily be replaced by test doubles (also referred to as <em>mocks</em>). Mocking concrete classes can be much more complex.</p>

<h2 id="class-and-method-size">Class and method size</h2>

<p>Try to keep the number of methods in a class and the number of lines of code per method as few as possible.</p>

<p>Shorter methods do less, which in turn means they are easier to test. The same is true for small classes.</p>

<p>As a rule of thumb, try to keep methods to five or fewer lines of code.</p>

<h3 id="each-function-has-one-single-purpose">Each function has one single purpose</h3>

<p>Functions should do only one thing and they should do it very well.</p>

<p>Once you respect the <a href="https://en.wikipedia.org/wiki/Single_responsibility_principle">single responsibility principle</a>, you will know exactly what you are testing and your functions will be smaller and clearer.
Have a look at the following examples:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="c1">// Wrong</span>

<span class="k">public</span> <span class="k">function</span> <span class="n">execute</span><span class="p">(</span><span class="nv">$customer</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">notifyCustomer</span><span class="p">(</span><span class="nv">$customer</span><span class="p">);</span>
<span class="p">}</span>

<span class="cd">/**
 * Save customer and notify by email
 */</span>
<span class="k">public</span> <span class="k">function</span> <span class="n">notifyCustomer</span><span class="p">(</span><span class="nv">$customer</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">customerRepository</span><span class="o">-&gt;</span><span class="nf">save</span><span class="p">(</span><span class="nv">$customer</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">email</span><span class="o">-&gt;</span><span class="nf">sendEmail</span><span class="p">(</span><span class="nv">$customer</span><span class="o">-&gt;</span><span class="nf">getEmail</span><span class="p">());</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>In the above example, the <code class="language-plaintext highlighter-rouge">notifyCustomer</code> method does more than the method’s name suggests. Such methods will be harder to maintain and can have some side effects you would not assume by its name.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="c1">// Correct</span>

<span class="k">public</span> <span class="k">function</span> <span class="n">execute</span><span class="p">(</span><span class="nv">$customer</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">saveCustomer</span><span class="p">(</span><span class="nv">$customer</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">notifyCustomer</span><span class="p">(</span><span class="nv">$customer</span><span class="o">-&gt;</span><span class="nf">getEmail</span><span class="p">());</span>
<span class="p">}</span>

<span class="cd">/**
 * Save Customer
 */</span>
<span class="k">public</span> <span class="k">function</span> <span class="n">saveCustomer</span><span class="p">(</span><span class="nv">$customer</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">customerRepository</span><span class="o">-&gt;</span><span class="nf">save</span><span class="p">(</span><span class="nv">$customer</span><span class="p">);</span>
<span class="p">}</span>

<span class="cd">/**
 * Notify customer by email
 */</span>
<span class="k">public</span> <span class="k">function</span> <span class="n">notifyCustomer</span><span class="p">(</span><span class="nv">$email</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">email</span><span class="o">-&gt;</span><span class="nf">sendEmail</span><span class="p">(</span><span class="nv">$email</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>In the correct example, the <code class="language-plaintext highlighter-rouge">notifyCustomer</code> method is slightly refactored, and the only thing it does is to notify the customer by email. The rest of the logic was moved into a separate method, which has a clear name.</p>

<h3 id="testing-private-and-protected-methods">Testing private and protected methods</h3>

<p>When you see the need to write tests for <code class="language-plaintext highlighter-rouge">private</code> scope methods, it usually is a sign that the class under test is doing too much.</p>

<p>Consider extracting the private functionality into a separate class and using that class as a collaborator. The extracted class then provides the functionality using a public method and can easily be tested.</p>

<h2 id="helpful-principles">Helpful principles</h2>

<p>Many good practices for software development in general and object oriented programming in particular have been formulated as principles over the last decades. Applying these rules of thumb helps to keep code in good shape and also leads to more easily testable code.</p>

<p>The following list principles are by no means complete, but they can serve as a starting point when you start to write testable code.</p>

<h3 id="tell-do-not-ask">Tell, do not ask</h3>

<p>Try to use a few getters as possible. Instead, use methods that tell the objects directly what to do. Asking for object values is a sign of misplaced responsibilities. <a href="https://en.wikipedia.org/wiki/Kent_Beck">Kent Beck</a> called that “feature envy”.</p>

<p>Consider moving the code in that needs the value into a class that has the data available as the following example shows:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">function</span> <span class="n">extractMatchingDocuments</span><span class="p">(</span><span class="kt">Document</span> <span class="nv">$searchDoc</span><span class="p">,</span> <span class="kt">array</span> <span class="nv">$documents</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nb">array_filter</span><span class="p">(</span><span class="nv">$documents</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="kt">Document</span> <span class="nv">$doc</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$searchDoc</span><span class="p">){</span>
        <span class="k">return</span> <span class="nv">$doc</span><span class="o">-&gt;</span><span class="nf">getFieldValue</span><span class="p">()</span> <span class="o">===</span> <span class="nv">$searchDoc</span><span class="o">-&gt;</span><span class="nf">getFieldValue</span><span class="p">();</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The following example moves the comparison into a <code class="language-plaintext highlighter-rouge">matches()</code> method on the <code class="language-plaintext highlighter-rouge">Document</code> class instead.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">function</span> <span class="n">extractMatchingDocuments</span><span class="p">(</span><span class="kt">Document</span> <span class="nv">$searchDoc</span><span class="p">,</span> <span class="kt">array</span> <span class="nv">$documents</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nb">array_filter</span><span class="p">(</span><span class="nv">$documents</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="kt">Document</span> <span class="nv">$doc</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$searchDoc</span><span class="p">){</span>
        <span class="k">return</span> <span class="nv">$searchDoc</span><span class="o">-&gt;</span><span class="nf">matches</span><span class="p">(</span><span class="nv">$doc</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="the-law-of-demeter">The Law of Demeter</h3>

<p>The <a href="https://en.wikipedia.org/wiki/Law_of_Demeter">Law of Demeter</a> principle is sometimes stated as “Talk to friends only” or “Do not talk to strangers.” It states that code can call methods only on objects that it received in one of the following ways:</p>

<ul>
  <li>Objects received as constructor arguments</li>
  <li>Objects received as arguments to the current method</li>
  <li>Objects instantiated in the current method</li>
</ul>

<p>The principle explicitly states that no method can be called on objects that are the return value of another method call. Calling method calls on returned objects introduces a hidden dependency on the returned object type.</p>

<p>The following example violates the Law of Demeter by calling the method <code class="language-plaintext highlighter-rouge">getByName()</code> on the return value of <code class="language-plaintext highlighter-rouge">getHeaders()</code>.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">function</span> <span class="n">isJsonResponse</span><span class="p">(</span><span class="kt">Response</span> <span class="nv">$response</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$headers</span> <span class="o">=</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">getHeaders</span><span class="p">();</span>
    <span class="k">return</span> <span class="nv">$headers</span><span class="o">-&gt;</span><span class="nf">getByName</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">)</span> <span class="o">===</span> <span class="s1">'application/json'</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The solution is to add the method <code class="language-plaintext highlighter-rouge">isJsonResponse()</code> to the response object instead.</p>

<p>Method chaining (for example, <code class="language-plaintext highlighter-rouge">$foo-&gt;getSomething()-&gt;setThat($x)-&gt;doBar()</code>) is often a sign of this problem. When testing this type of code, you must often create test doubles that must be set up to return other test doubles and so on (“Mocks returning mocks…”).</p>

<h3 id="i-do-not-care">“I do not care”</h3>

<p>An interesting approach to writing more testable code is to try to delegate as much as possible to other classes. Every time any currently not available resource is needed, just think “I do not care where that comes from” and add a collaborator class that provides it.</p>

<p>At first this might seem like it causes the number of classes to explode, but in fact each one of the classes is very short and simple and usually has very limited responsibilities.</p>

<p>Almost as a side effect, those classes are very easy to test.</p>

<h2 id="for-more-information">For more information</h2>

<ul>
  <li><a href="https://martinfowler.com/bliki/BeckDesignRules.html">Rules of simple software design</a> by Kent Beck</li>
  <li><a href="https://books.google.com/books/about/Clean_Code.html?id=dwSfGQAACAAJ">Clean Code</a> by Robert C. Martin</li>
  <li><a href="https://martinfowler.com/books/refactoring.html">Refactoring</a> by Martin Fowler</li>
  <li><a href="https://www.growing-object-oriented-software.com">Growing Object Oriented Software Guided by Tests</a> by Steve Freeman and Nat Pryce</li>
</ul>

<!-- Link definitions -->

			</main>
			<footer class="content-footer">
				<button class="page-updated spectrum-ActionButton spectrum-ActionButton--sizeM spectrum-ActionButton--quiet">
  <img class="spectrum-Icon spectrum-Icon--sizeS" src="/devdocs-archive/2.3/assets/i/icons/time.svg" alt="Updated" />
  <time class="spectrum-ActionButton-label" id="last-modified-at" itemprop="dateModified"
    datetime="2022-08-01">
    Aug 1st, 2022
  </time>
</button>

			</footer>
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

  <div class="page-contributor">
  <a href="https://vinaikopp.com/" target="_blank">
    Thanks to Vinai Kopp for contributing this topic
  </a>
</div>

</div>


	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->

</div>
<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
    <div class="container">
  
      <div class="copyright-links">
        

<ul class="nav footer-links" role="menu">

  <li class="  " role="menuitem"><a href="https://github.com/magento/devdocs/blob/master/.github/CONTRIBUTING.md" class=" ">Become a Contributor</a></li>

  <li class="  " role="menuitem"><a href="https://glossary.magento.com/" class=" ">Glossary</a></li>

  <li class="  " role="menuitem"><a href="https://magento.com/legal/terms/privacy/" class=" ">Privacy Policy</a></li>

  <li class="  " role="menuitem"><a href="https://magento.com/legal/terms/" class=" ">Terms of Service</a></li>

  <li class="  " role="menuitem"><a href="https://magento.com/legal/licensing/" class=" ">License/Trademark FAQ</a></li>

  <li class="  " role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/release-notes/bk-release-notes.html" class=" ">Release Notes</a></li>

  <li class="  " role="menuitem"><a href="/devdocs-archive/2.3/guides/v2.3/release-notes/packages-open-source.html" class=" ">Third-Party Licenses</a></li>

</ul>

      </div>
  
          <div class="copyright-date">&copy; 2023 Adobe. All rights reserved.</div>
  
    </div>
  </div>
  <!-- / #footer -->
  
  


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/devdocs-archive/2.3/assets/js/app.min.js?ver=20"></script>
<script src="/devdocs-archive/2.3/assets/js/editions.min.js?ver=20"></script>
<script src="/devdocs-archive/2.3/assets/js/page-updated.min.js?ver=20"></script>





<script type="text/javascript" src="/devdocs-archive/2.3/common/js/glossary-link-enhancer.js"></script>


</body>

</html>
