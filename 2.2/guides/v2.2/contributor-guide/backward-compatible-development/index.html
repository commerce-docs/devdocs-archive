<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>Backward compatible development | Archived Magento 2.2 Developer Documentation</title>
	<meta name="description" content="Archived Magento 2 Developer Documentation.">

	<link rel="stylesheet" href="/devdocs-archive/2.2/assets/css/app.css?ver=7" />
	<link rel="stylesheet" href="/devdocs-archive/2.2/assets/css/print.css?ver=7" media="print"/>

	<link rel="stylesheet" href="/devdocs-archive/2.2/common/css/devdocs.css" />
<link rel="alternate" type="application/rss+xml" title="Magento DevDocs RSS" href="/feed.xml" />



<meta name="google-site-verification" content="3WFsoYwBe6UuxDwgs7bmd7t0YFQVzDpLpWLjNh0CUp8" />

	<script>
  var baseUrl = "/devdocs-archive/2.2";
  var algolia = {
    id : "E642SEDTHL",
    index:  "devdocs",
    key:  "d2d0f33ab73e291ef8d88d8b565e754c",
  };

  var indices = [
    {
      label: "DevDocs",
      name: "devdocs",
      facetFilters: [["guide_version: 2.2", "versionless: true"]],
      refinements: [
        {
          label: "Functional areas",
          attribute: "functional_areas"
        }
      ],
      baseUrl: "https://devdocs.magento.com"
    },
    {
      label: "User Guide",
      name: "merchdocs_ee",
      baseUrl: "https://docs.magento.com/m2/ee/user_guide"
    },
    {
      label: "MBI User Guide",
      name: "merchdocs-mbi",
      baseUrl: "https://docs.magento.com/mbi"
    },
    {
      label: "Marketplace User Guide",
      name: "merchdocs-marketplace",
      baseUrl: "https://docs.magento.com/marketplace/user_guide"
    },
    {
      label: "PWA",
      name: "pwa-devdocs",
      baseUrl: "https://magento.github.io/pwa-studio"
    },
    {
      label: "Order Management",
      name: "oms-en",
      baseUrl: "https://omsdocs.magento.com"
    }
  ];
</script>




	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
	<link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
	<link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>
<body class="layout-default">


	<header class="site-header">
		

<nav class="site-nav">

  <div class="nav-container">

    <div class="menu-btn">
      <button id="menu-btn" class="menu-trigger menu-icon" aria-haspopup="true" aria-controls="nav-main" aria-label="Menu"></button>
    </div>

    <a class="logo" href="/devdocs-archive/2.2/">
      <img src="/devdocs-archive/2.2/assets/i/m-logo.svg" alt=""><img src="/devdocs-archive/2.2/assets/i/magento-logo.svg" alt="Magento" class="magento-logo" />
      <span class="site-logo">DevDocs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      


<div class="version-switcher dropdown">
	<button class="btn dropdown-toggle" disabled>
		Magento 2.2
	</button>
</div>


      <!-- Main Navigation --><ul class="nav-main" role="menubar"><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Cloud</span><div class="nav-popup"><div class="nav-section">
              <div class="nav-section-title">Cloud basics</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/bk-cloud.html">Cloud Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/architecture/cloud-architecture.html">Cloud Architecture</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-upgrade-parent.html">Upgrades and Patches</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/release-notes/cloud-tools.html">Release Notes</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">Cloud development</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/setup/first-time-setup.html">Local development</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/docker/docker-config.html">Launch Docker</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/docker/docker-quick-reference.html">Docker quick reference</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/environments.html">Configure Environments</a></li></ul>
            </div></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Setup</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/install-gde/bk-install-guide.html">Installation Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/extensions/">Magento Extensions Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/comp-mgr/bk-compman-upgrade-guide.html">Software Update Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/config-guide/bk-config-guide.html">Configuration Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/performance-best-practices/introduction.html">Performance Best Practices</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/migration/bk-migration-guide.html">Migration Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/release-notes/bk-release-notes.html">Release Information</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/reference/cli/magento.html">Command-line Tools Reference</a></li></ul></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Development</span><div class="nav-popup"><div class="nav-section">
              <div class="nav-section-title">Backend</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/architecture/bk-architecture.html">Architecture</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/extension-dev-guide/bk-extension-dev-guide.html">PHP Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/ext-best-practices/bk-ext-best-practices.html">Extension Developer Best Practices</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/mrg/intro.html">Module Reference Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/coding-standards/bk-coding-standards.html">Coding Standards</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/contributor-guide/contributing.html">Contributor Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">Frontend</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/frontend-dev-guide/bk-frontend-dev-guide.html">Frontend Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/ui_comp_guide/bk-ui_comps.html">UI Components Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/javascript-dev-guide/bk-javascript-dev-guide.html">JavaScript Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/pattern-library/bk-pattern.html">Admin Design Pattern Library</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/design-styleguide/bk-styleguide.html">Admin Style Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">API</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/get-started/bk-get-started-api.html">Get Started with Magento Web APIs</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/rest/bk-rest.html">REST API Reference</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/soap/bk-soap.html">SOAP API Reference</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/marketplace/eqp/v1/api.html">Marketplace EQP API Reference</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/mbi/docs/getting-started.html">Business Intelligence API</a></li></ul>
            </div></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Testing</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/test/testing.html">Magento Testing Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/mftf/docs/introduction.html">Functional Acceptance Testing (MFTF)</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/mtf/mtf_introduction.html">Functional Testing</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/test/integration/integration_test_execution.html">Integration Testing</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/test/js/jasmine.html">JavaScript Unit Testing</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/test/unit/unit_test_execution.html">PHP Unit Testing</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/get-started/web-api-functional-testing.html">Web API Functional Testing</a></li></ul></div></li><li class="nav-main-separator"></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Functional Areas</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/advanced-reporting/overview.html">Advanced Reporting</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/b2b/bk-b2b.html">B2B</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/howdoi/checkout/checkout_overview.html">Checkout</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/compliance/industry-compliance.html">Compliance</a></li><li class="" role="menuitem"><a href="http://omsdocs.magento.com/en/">Order Management</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/payments-integrations/bk-payments-integrations.html">Payment Integrations</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/extension-dev-guide/staging.html">Staging</a></li></ul></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Tutorials</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/rest/tutorials/index.html">Rest Tutorials</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/howdoi/customize_product.html">Customize Product Creation Form</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/howdoi/checkout/checkout_overview.html">Customize Checkout</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/community/resources/support.html">Magento Support</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/videos/">Video Tutorials</a></li></ul></div></li></ul><!-- /.nav-main -->

    </div>

    <div class="nav-actions">
      
<div class="app-switcher">
  <div class="dropdown">
    <button id="app-switcher-trigger" class="app-switcher-trigger" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="Documentation sites"></button>
    <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="app-switcher-trigger" role="menu">
      <div class="app-switcher-content">
      
      <div class="app-switcher-group">
        <h3 class="app-swither-group-title">Developer</h3>
        
        <li role="menuitem"><a class="dropdown-item" href="https://devdocs.magento.com/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Commerce Developer Documentation">Commerce Developer Documentation</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="http://pwastudio.io/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=PWA Studio">PWA Studio</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="https://omsdocs.magento.com/en/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Order Management">Order Management</a></li>
        
      </div>
      
      <div class="app-switcher-group">
        <h3 class="app-swither-group-title">Merchant</h3>
        
        <li role="menuitem"><a class="dropdown-item" href="https://docs.magento.com/m2/ee/user_guide/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Commerce User Guide">Commerce User Guide</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="https://omsdocs.magento.com/en/userguides/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Order Management">Order Management</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="https://docs.magento.com/mbi/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Business Intelligence">Business Intelligence</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="https://docs.magento.com/marketplace/user_guide/getting-started.html?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Marketplace">Marketplace</a></li>
        
      </div>
      
      </div>
    </ul>
  </div>
</div>

    </div>

  </div>

</nav><!-- #site-nav -->
<div class="nav-main-fader"></div>

	</header>

	<div class="global-wrapper">
		
		<div class="main-container">
			<a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
	<button class="toc-toggler">Table of Contents</button>
	<div class="sidebar-wrapper">

		

		<h4 class="guide-title">Contribution Guide</h4>
		<div class="collapsible-navigation">
		    <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/contributor-guide/contributing.html">Code Contributions</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/contributor-guide/contributing_dod.html">Magento Definition of Done</a></li><li class="active" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/contributor-guide/backward-compatible-development/">Backward compatible development</a></li></ul></li><li class="" role="menuitem"><span>DevDocs Contributions</span><ul><li class="" role="menuitem"><a href="https://github.com/magento/devdocs/blob/master/.github/CONTRIBUTING.md">Contribution Guidelines</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/contributor-guide/contributing_docs_suggested.html">Suggested topics for contribution</a></li><li class="" role="menuitem"><span>Templates</span><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/contributor-guide/templates/basic_template.html">Basic template</a></li><li class="tutorial" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/contributor-guide/templates/tutorial-template-first.html">Sample template tutorial</a></li></ul></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/contributor-guide/contributors.html">Contributors</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/contributor-guide/maintainers.html">Maintainers</a></li></ul>
		</div>

	</div>

</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<!-- page-header -->
<section class="page-intro">








<h1 class="page-heading">Backward compatible development</h1>
</section>

			<p>This page describes rules and best practices for backward compatible development.</p>

<h2 id="backward-compatibility-policy">Backward Compatibility Policy</h2>

<p>See the <a href="/devdocs-archive/2.2/guides/v2.2/extension-dev-guide/versioning/index.html">versioning</a> documentation for the definitions of MAJOR and MINOR changes and how it impacts <a href="https://glossary.magento.com/extension">extension</a> developers.</p>

<p>The core Magento team and contributing developers work in two release types</p>

<ol>
  <li>New and significant release (product’s MINOR release)
    <ul>
      <li>Necessary MAJOR and MINOR changes are allowed, but the Magento architecture team ultimately decides what is allowed.</li>
    </ul>
  </li>
  <li>New patch release (product’s PATCH release)
    <ul>
      <li>PATCH changes are allowed, but MAJOR and MINOR changes are not allowed.</li>
    </ul>
  </li>
</ol>

<p class="bs-callout-info">Backward Compatibility Policy is not applied to Plugins, Observers and Setup Scripts.</p>

<h2 id="prohibited-code-changes">Prohibited code changes</h2>

<p>The following modifications are forbidden for <code class="language-plaintext highlighter-rouge">@api</code> code without the approval of the <strong>Magento architect</strong>, <strong>Product Manager</strong> and <strong>Engineering Manager</strong> assigned to the component.</p>

<p class="bs-callout-info">The rules listed do not apply to customization code (e.g. Plugins, Observers, JS Mixins, etc.).</p>

<h3 id="composer">Composer</h3>

<h4 id="introducing-a-new-dependency-from-an-existing-module">Introducing a new dependency from an existing module</h4>

<p>Introducing a new dependency from an existing module is a backward incompatible change because we cannot guarantee when Magento will enable the required module. As a result, we cannot satisfy the dependency in this way.</p>

<h3 id="php">PHP</h3>

<p>The following is a list of prohibited <a href="https://glossary.magento.com/php">PHP</a> code changes and possible alternative implementations.</p>

<h4 id="interfaceclass-removal">Interface/class removal</h4>

<p>Mark the class with the <code class="language-plaintext highlighter-rouge">@deprecated</code> tag instead of removing it, and mark all of its methods as deprecated so an IDE can highlight them as deprecated.</p>

<h4 id="public-and-protected-method-removal">Public and protected method removal</h4>

<p>Mark the method with the <code class="language-plaintext highlighter-rouge">@deprecated</code> tag instead of removing it.</p>

<p>Continue returning the same results from the method if possible, so the old functionality is preserved.</p>

<h4 id="introduction-of-a-method-to-a-class-or-interface">Introduction of a method to a class or interface</h4>

<p>Create a new interface with a new method instead of introducing a method to a class or interface.</p>

<p>The new interface may take over existing methods from the class if it makes sense to group them together.
In this case, you must deprecate corresponding methods in the old interface/class with the <code class="language-plaintext highlighter-rouge">@see</code> annotation.
The old methods should proxy the calls to the new interface instead of duplicating the logic.</p>

<p>For an example of an interface with an extracted method see the <code class="language-plaintext highlighter-rouge">Magento\Catalog\Api\CategoryListInterface</code>.
This interface is responsible for the <code class="language-plaintext highlighter-rouge">getList()</code> method, but <code class="language-plaintext highlighter-rouge">Magento\Catalog\Api\CategoryRepositoryInterface</code> does not have that method.</p>

<ul>
  <li>For a <strong>PATCH</strong> product release, do NOT mark the new interface with <code class="language-plaintext highlighter-rouge">@api</code>.</li>
  <li>For a <strong>MINOR</strong> product release, an architect marks, or approves, the new interface with <code class="language-plaintext highlighter-rouge">@api</code> if applicable.</li>
</ul>

<h4 id="removing-static-functions">Removing static functions</h4>

<p>Do not remove static functions.</p>

<h4 id="adding-parameters-in-public-methods">Adding parameters in public methods</h4>

<p>Deprecate the method and add a new method with the new parameter(s) instead of adding them to a public method.</p>

<p>Follow the alternative implementation described earlier for introducing a new method to a class or interface.</p>

<p>Reference the new method in a <code class="language-plaintext highlighter-rouge">@see</code> tag as a recommended replacement.
Explain the reasons for replacing the old method with the new one (e.g., there is a bug in the old method).</p>

<h4 id="adding-parameters-in-protected-methods">Adding parameters in protected methods</h4>

<p>Instead of adding parameters to protected methods, Create a new method with a new signature and deprecate the old method without changing it.</p>

<p>Declare the new method as private if possible.</p>

<p>Example code:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="cd">/**
- @deprecated This method is not intended for usage in child classes
- @see updateScopedPrice($price, $storeId)
 */</span>
<span class="k">protected</span> <span class="k">function</span> <span class="n">updatePrice</span><span class="p">(</span><span class="nv">$price</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">updateScopedPrice</span><span class="p">(</span><span class="nv">$price</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">function</span> <span class="n">updateScopedPrice</span><span class="p">(</span><span class="nv">$price</span><span class="p">,</span> <span class="nv">$storeId</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Updated logic that takes into account $storeId</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="modifying-the-default-values-of-optional-arguments-in-public-and-protected-methods">Modifying the default values of optional arguments in public and protected methods</h4>

<p>This is forbidden because the default argument values of public or protected methods are part of the <a href="https://glossary.magento.com/api">API</a> of the class/interface.</p>

<p>As an alternative, Create a new method with new interface following the alternative implementation for creating a new method for a class or interface.</p>

<p>Create multiple methods to cover all use cases to avoid using optional parameters.</p>

<h4 id="modifying-the-method-argument-type">Modifying the method argument type</h4>

<p>Do not modify a method argument type.</p>

<h4 id="modifying-the-types-of-thrown-exceptions">Modifying the types of thrown exceptions</h4>

<p>Do not modify the types of thrown exceptions unless a new <a href="https://glossary.magento.com/exception">exception</a> is a sub-type of the old one.</p>

<h4 id="throwing-a-new-type-of-exception-from-an-existing-method">Throwing a new type of exception from an existing method</h4>

<p>You SHOULD NOT throw a new type of exception from an existing method. The existing clients of the method may not expect this change and consequently fail to properly handle the exception.</p>

<h4 id="adding-a-constructor-parameter">Adding a constructor parameter</h4>

<p>Add a new optional parameter to the constructor at the end of the arguments list instead of modifying the constructor.</p>

<p>In the constructor body, if the new dependency is not provided (i.e. the value of the introduced argument is <code class="language-plaintext highlighter-rouge">null</code>), fetch the dependency using <code class="language-plaintext highlighter-rouge">Magento\Framework\App\ObjectManager::getInstance()</code>.</p>

<p>Prefix the type name with a question mark when declaring a parameter with a <code class="language-plaintext highlighter-rouge">null</code> default value.</p>

<div class="collapsible">
    <b class="collapsible-title">Example Code </b>
    <div class="collapsible-content"><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">ExistingClass</span>
<span class="p">{</span>
    <span class="cd">/** @var \New\Dependency\Interface */</span>
    <span class="k">private</span> <span class="nv">$newDependency</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span>
        <span class="err">\</span><span class="nc">Old\Dependency\Interface</span> <span class="nv">$oldDependency</span><span class="p">,</span>
        <span class="nv">$oldRequiredConstructorParameter</span><span class="p">,</span>
        <span class="nv">$oldOptionalConstructorParameter</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span>
        <span class="o">?</span><span class="err">\</span><span class="k">New</span><span class="err">\</span><span class="nc">Dependency\Interface</span> <span class="nv">$newDependency</span> <span class="o">=</span> <span class="kc">null</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="mf">...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">newDependency</span> <span class="o">=</span> <span class="nv">$newDependency</span> <span class="o">?:</span> <span class="err">\</span><span class="nc">Magento\Framework\App\ObjectManager</span><span class="o">::</span><span class="nf">getInstance</span><span class="p">()</span><span class="o">-&gt;</span><span class="nf">get</span><span class="p">(</span><span class="err">\</span><span class="k">New</span><span class="err">\</span><span class="nc">Dependency\Interface</span><span class="o">::</span><span class="n">class</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">existingFunction</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// Existing functionality</span>
        <span class="mf">...</span>
        <span class="mf">...</span>

        <span class="c1">// Use $this-&gt;newDependency wherever the new dependency is needed</span>
        <span class="mf">...</span>
        <span class="mf">...</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Sample unit test code snippet follows</span>
<span class="kd">class</span> <span class="nc">ExistingClassTest</span> <span class="k">extends</span> <span class="err">\</span><span class="n">PHPUnit_Framework_TestCase</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$existingClassObject</span><span class="p">;</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="n">setUp</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="mf">...</span>
        <span class="c1">// Create dependency mocks with $this-&gt;getMock() or $this-&gt;getMockBuilder()</span>
        <span class="nv">$newDependencyMock</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">getMock</span><span class="p">(</span><span class="err">\</span><span class="k">New</span><span class="err">\</span><span class="nc">Dependency\Interface</span><span class="o">::</span><span class="n">class</span><span class="p">);</span>

        <span class="nv">$objectManager</span> <span class="o">=</span> <span class="k">new</span> <span class="err">\</span><span class="nf">Magento\Framework\TestFramework\Unit\Helper\ObjectManager</span><span class="p">(</span><span class="nv">$this</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">existingClassObject</span> <span class="o">=</span> <span class="nv">$objectManager</span><span class="o">-&gt;</span><span class="nf">getObject</span><span class="p">(</span>
            <span class="nc">ExistingClass</span><span class="o">::</span><span class="n">class</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="s1">'oldDependency'</span> <span class="o">=&gt;</span> <span class="nv">$oldDependencyMock</span><span class="p">,</span>
                <span class="s1">'oldRequiredConstructorParameter'</span> <span class="o">=&gt;</span> <span class="s1">'foo'</span><span class="p">,</span>
                <span class="s1">'oldOptionalConstructorParameter'</span> <span class="o">=&gt;</span> <span class="s1">'bar'</span><span class="p">,</span>
                <span class="s1">'newDependency'</span> <span class="o">=&gt;</span> <span class="nv">$newDependencyMock</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">testExistingFunction</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="mf">...</span>
        <span class="mf">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
</div>
  </div>

<h4 id="removing-or-renaming-public-and-protected-properties">Removing or renaming public and protected properties</h4>

<p>Mark properties with the <code class="language-plaintext highlighter-rouge">@deprecated</code> tag instead of removing or renaming them.
Continue storing the value in the property to preserve the old functionality.</p>

<h4 id="removing-or-renaming-constants">Removing or renaming constants</h4>

<p>Do not remove or rename constants.</p>

<h4 id="removing-renaming-or-changing-the-type-of-event-arguments">Removing, renaming, or changing the type of event arguments</h4>

<p>Do not remove or rename <a href="https://glossary.magento.com/event">event</a> arguments.
Do not change argument types.
Instead of changing argument name or type, introduce new event argument with new name or type and deprecate the old argument by adding <code class="language-plaintext highlighter-rouge">@deprecated</code> annotation before dispatching the event.</p>

<p>Example code:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nv">$transportObject</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataObject</span><span class="p">(</span><span class="nv">$transport</span><span class="p">);</span>

<span class="cd">/**
 * Event argument `transport` is @deprecated. Use `transport_object` instead.
 */</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="n">eventManager</span><span class="o">-&gt;</span><span class="nf">dispatch</span><span class="p">(</span>
    <span class="s1">'email_invoice_set_template_vars_before'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'sender'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">'transport'</span> <span class="o">=&gt;</span> <span class="nv">$transportObject</span><span class="o">-&gt;</span><span class="nf">getData</span><span class="p">(),</span> <span class="s1">'transport_object'</span> <span class="o">=&gt;</span> <span class="nv">$transportObject</span><span class="p">]</span>
<span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="js">JS</h3>

<p>The following is a list of prohibited JS code changes:</p>

<ul>
  <li>Removing or renaming an interface or class</li>
  <li>Removing or renaming public or protected methods</li>
  <li>Introducing a method to an interface</li>
  <li>Introducing an abstract method to a class</li>
  <li>Removing or renaming static functions</li>
  <li>Adding non-optional arguments in public and protected methods</li>
  <li>Modifying the default value for optional arguments in public and protected methods</li>
  <li>Removing or renaming public or protected properties</li>
  <li>Removing or renaming constants</li>
</ul>

<h3 id="xml-schema">XML Schema</h3>

<p>The following is a list of prohibited <a href="https://glossary.magento.com/xml">XML</a> Schema changes:</p>

<ul>
  <li>Adding an obligatory node</li>
  <li>Adding an obligatory attribute</li>
  <li>Removing or renaming an attribute or node type</li>
  <li>Removing or renaming a configuration file</li>
</ul>

<h3 id="db-schema">DB Schema</h3>

<p>The following is a list of prohibited DB Schema changes:</p>

<ul>
  <li>Modifying field type, default value, or property</li>
  <li>Removing or renaming a table</li>
  <li>Introducing a required field</li>
</ul>

<h3 id="cssless">CSS/Less</h3>

<p>The following is a list of prohibited CSS/Less changes:</p>

<ul>
  <li>Removing or renaming a class</li>
  <li>Removing or renaming a mix-in</li>
  <li>Removing or renaming a variable</li>
</ul>

<h3 id="magento-apis">Magento APIs</h3>

<p>The following is a list of prohibited Magento API changes:</p>

<ul>
  <li>Removing or renaming an event</li>
  <li>Removing or renaming a <a href="https://glossary.magento.com/layout">layout</a> handle</li>
  <li>Removing or renaming a store configuration path</li>
  <li>Modifying the directory structure</li>
  <li>Removing an @api annotation</li>
  <li>Modifying the Magento tool command argument list</li>
  <li>Modifying or removing the Magento tool command</li>
  <li><a href="/devdocs-archive/2.2/guides/v2.2/extension-dev-guide/message-queues/config-mq.html">Topic names for message queue</a>, except automatically generated names (e.g. topic names generated by <a href="/devdocs-archive/2.2/guides/v2.2/rest/asynchronous-web-endpoints.html">Asynchronous Web API</a>. Automatically generated topic names should be treated as private implementation and may be changed at any time if needed.</li>
</ul>

<h3 id="translatable-phrases">Translatable phrases</h3>

<p>Do not modify or add any translatable phrase.</p>

<h3 id="magento-functional-and-integration-tests">Magento functional and integration tests</h3>

<p>The following is a list of prohibited changes to Magento functional and integration tests:</p>

<ul>
  <li>Changing a fixture format</li>
  <li>Changing a fixture content (except changes forced by new functionality)</li>
</ul>

<h2 id="allowed-code-changes">Allowed Code Changes</h2>

<h3 id="php-1">PHP</h3>

<h4 id="changing-the-value-of-a-constant">Changing the value of a constant</h4>

<p>Changing the value of a constant is itself a backward compatible change.</p>

<p>Even if client code saves the value in permanent storage or use it as input or output of a method, it is the responsibility of that code to ensure that it is a reliable implementation.</p>

<p>The client code should have enough control over the constant’s value.
Do not rely on a value of a constant from another <a href="https://glossary.magento.com/module">module</a> or another vendor.</p>

<h4 id="stop-setting-a-value-to-the-registry">Stop setting a value to the Registry</h4>

<p>Setting a value to the Registry is backward compatible.
However, Magento discourages usage of the Registry, so third-party extensions should not depend on values in the Registry.</p>

<h4 id="adding-an-argument-to-an-event">Adding an argument to an event</h4>

<p>Adding an argument to an event is allowed.</p>

<h2 id="version-changing-rules-for-module-setup">Version changing rules for module setup</h2>

<ol>
  <li>
    <p>The module data/schema version must not increase in a patch version release if the next minor version is already released.</p>

    <p>For example, the module data/schema version for all patch releases of Magento 2.0 can change prior to the release of Magento 2.1.
After 2.1 releases, the version cannot change for 2.0 patch releases, but it can change for 2.1 patch releases until Magento 2.2.</p>
  </li>
  <li>
    <p>Deliver fixes that bump the module setup/data version in the current, unpublished version before delivering it to previous minor versions.
In cases where an urgent fix was delivered in a previous minor version, treat the fix for the current unpublished version as a high priority task.</p>

    <p>For example, issue fixes that change the setup/upgrade version in the unreleased <code class="language-plaintext highlighter-rouge">develop</code> branch are delivered first before being ported into the released branches.
If the fix was made for a released branch, a pull request for porting it into the <code class="language-plaintext highlighter-rouge">develop</code> branch must be created with a high priority and delivered as soon as possible.</p>
  </li>
  <li>
    <p>The setup version of a module must be higher than previous releases of the same module.</p>

    <p>For example, the setup version for a fix for the Magento_Catalog module is higher in the <code class="language-plaintext highlighter-rouge">develop</code> branch (2.1.3) than previous branch versions (2.0.2 and 2.1.2 for versions 2.0 and 2.1).</p>
  </li>
</ol>

<h2 id="backporting-fixes-with-breaking-changes-to-patch-branches">Backporting fixes with breaking changes to patch branches</h2>

<p>Backward compatibility is more important than niceness and implementation effort, but a Magento architect must be involved in making a decision.</p>

<p>Potential drawbacks:</p>

<ul>
  <li>It is double the work when it is necessary to implement different solutions for the <code class="language-plaintext highlighter-rouge">develop</code> branch (upcoming minor release) and patch release branches.</li>
  <li>Inability to refactor code in patch releases</li>
  <li>Effort for implementing fixes in patch releases may be higher due to necessary implementation workarounds.</li>
</ul>

<h2 id="refactoring-classes-that-reach-limit-of-coupling-between-objects">Refactoring classes that reach limit of coupling between objects</h2>

<p>Poorly designed classes with too many responsibilities and dependencies should be refactored to prevent them from reaching the limit of coupling between objects, but removing excessive dependencies and/or breaking the class down into smaller classes is a backward incompatible implementation.</p>

<p>Preserve public and protected class interfaces to maintain backward compatibility.
Review and refactor the class such that parts of the logic go into smaller specialized classes without breaking backward compatibility.</p>

<ul>
  <li>Turn the existing class into a facade to prevent existing usages of the refactored methods from breaking.</li>
  <li>The old public/protected methods should be marked as deprecated with the <code class="language-plaintext highlighter-rouge">@see</code> tag to suggest the new implementation for new usages.</li>
  <li>Remove all unused private properties/methods.</li>
  <li>Mark as deprecated unused protected properties. Remove the variable type indicated in the DocBlock to remove the dependency.</li>
  <li>To preserve the constructor signature:
    <ul>
      <li>Remove type hinting for unused parameters to remove dependency on their type.</li>
      <li>Add <code class="language-plaintext highlighter-rouge">@SuppressWarnings(PHPMD.UnusedFormalParameter)</code> for unused parameters.</li>
    </ul>
  </li>
</ul>

<h2 id="deprecation">Deprecation</h2>

<p>Magento 2 must not have alternative APIs.
Whenever you introduce a new implementation of some behavior, mark the old implementation as deprecated and specify the reason.</p>

<h3 id="php-js-and-xml">PHP, JS, and XML</h3>

<p>Use the <code class="language-plaintext highlighter-rouge">@deprecated</code> tag to mark methods as deprecated and follow it up with an explanation.</p>

<p>Use the  <code class="language-plaintext highlighter-rouge">@see</code> tag to recommend the new API to use instead of the old one.</p>

<p>Preserve <code class="language-plaintext highlighter-rouge">@api</code> tag when deprecating <code class="language-plaintext highlighter-rouge">@api</code>-marked code.</p>

<h4 id="deprecating-in-php-and-js">Deprecating in PHP and JS</h4>

<p>Comment:</p>

<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="go">/**
 * @deprecated because newAPI  was introduced
 * @see \New\Api
 */
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>Trigger a deprecation message in deprecated functions/classes to notify extensions/customizations that use them.</p>

<p>PHP:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">trigger_error</span><span class="p">(</span><span class="s1">'Class is deprecated'</span><span class="p">,</span> <span class="kc">E_USER_DEPRECATED</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>JS:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nx">console</span><span class="p">.</span><span class="nf">warn</span><span class="p">(</span><span class="dl">'</span><span class="s1">Function is deprecated</span><span class="dl">'</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="deprecating-in-xmlhtml">Deprecating in XML/HTML</h4>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="c">&lt;!--
@deprecated because newAPI  was introduced
@see NewApi
--&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="webapi">WebAPI</h3>

<p>When replacing a WebAPI method with a new implementation that has a different signature, make sure it remains accessible on the same resource but with the next sequential version.</p>

<h3 id="deprecation-testing">Deprecation testing</h3>

<p>Every piece of code that is deprecated MUST be covered by a static test that will fail if some code uses the deprecated piece of code.</p>

<h3 id="removal-of-deprecated-code">Removal of deprecated code</h3>

<p>Deprecated code is preserved for the following time frames:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@api</code> code: Until the next major version of the component</li>
  <li>non-<code class="language-plaintext highlighter-rouge">@api</code> code: The next 2 minor releases or until a major release</li>
</ul>

<h2 id="documentation-of-backward-incompatible-changes">Documentation of Backward Incompatible Changes</h2>

<p>Backward incompatible changes must be approved by an architect and documented in the scope of the task that introduces those changes.</p>

<p>Examples of these tasks include:</p>

<ul>
  <li>Changing the input/output values format of a method</li>
  <li>Changing a value format in the DB</li>
  <li>Changing XML files (layouts, configuration files, etc.)</li>
</ul>

<p>Some changes are detected and documented by an automated tool.
These backward incompatible changes do not need manual documentation:</p>

<ul>
  <li>Adding/removing a class/interface</li>
  <li>Adding/removing a method</li>
  <li>Modifying a method signature</li>
  <li>Adding/removing a class/interface constant</li>
  <li>Adding removing a class property</li>
</ul>

<p>Auto-generated <a href="/devdocs-archive/2.2/guides/v2.2/release-notes/backward-incompatible-changes/open-source.html">Magento Open Source changes</a></p>

<p>Auto-generated <a href="/devdocs-archive/2.2/guides/v2.2/release-notes/backward-incompatible-changes/commerce.html">Magento Commerce changes</a></p>

<h3 id="where-to-document">Where to document</h3>

<p>In the <a href="https://github.com/magento/devdocs">DevDocs repository</a>, manually add backward incompatible changes to the following file:</p>

<p><code class="language-plaintext highlighter-rouge">https://github.com/magento/devdocs/blob/develop/guides/v&lt;version&gt;/release-notes/backward-incompatible-changes/index.md</code></p>

<p>Where: <code class="language-plaintext highlighter-rouge">&lt;version&gt;</code> is the MINOR version of the product (2.1, 2.2, 2.3, etc).</p>

<p>Example: <a href="https://github.com/magento/devdocs/blob/develop/guides/v2.2/release-notes/backward-incompatible-changes/index.md"><code class="language-plaintext highlighter-rouge">https://github.com/magento/devdocs/blob/develop/guides/v2.2/release-notes/backward-incompatible-changes/index.md</code></a>.</p>

<p>Update the page for the <em>next</em> MINOR product release when working in the <code class="language-plaintext highlighter-rouge">develop</code> branch of Magento.</p>

<p>For example, when 2.2 is released, a new <code class="language-plaintext highlighter-rouge">backward-incompatible-changes.md</code> for 2.3 becomes available for editing.</p>

<p>In order to update the page, create a PR to the DevDocs repository with your changes.</p>

<!-- Link definitions -->


			
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

  
  <div class="page-updated">
    <img src="/devdocs-archive/2.2/i/icons/time.svg" alt="Updated" />
    <time id="last-modified-at" itemprop="dateModified" datetime="2019-12-03">
      Dec 3rd, 2019
    </time>
  </div>
  

  

  

  

</div>


	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->


	</div>
	<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      

<ul class="nav footer-links" role="menu">

  <li class="" role="menuitem"><a href="https://github.com/magento/devdocs/blob/master/.github/CONTRIBUTING.md">Become a Contributor</a></li>

  <li class="" role="menuitem"><a href="https://glossary.magento.com/">Glossary</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/terms/privacy/">Privacy Policy</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/terms/">Terms of Service</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/licensing/">License/Trademark FAQ</a></li>

  <li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/release-notes/bk-release-notes.html">Release Notes</a></li>

  <li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/release-notes/packages-open-source.html">Third-Party Licenses</a></li>

</ul>

    </div>

		<div class="copyright-date">&copy; 2023 Magento. All rights reserved.</div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/devdocs-archive/2.2/assets/js/app.min.js?ver=7"></script>





<script type="text/javascript" src="/devdocs-archive/2.2/common/js/last-modified-at.js"></script>
<script type="text/javascript" src="/devdocs-archive/2.2/common/js/glossary-link-enhancer.js"></script>


</body>
</html>

