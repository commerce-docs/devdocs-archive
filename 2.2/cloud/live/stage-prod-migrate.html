<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>Deploy code and migrate static files and data | Archived Magento 2.2 Developer Documentation</title>
	<meta name="description" content="Archived Magento 2 Developer Documentation.">

	<link rel="stylesheet" href="/devdocs-archive/2.2/assets/css/app.css?ver=7" />
	<link rel="stylesheet" href="/devdocs-archive/2.2/assets/css/print.css?ver=7" media="print"/>

	<link rel="stylesheet" href="/devdocs-archive/2.2/common/css/devdocs.css" />
<link rel="alternate" type="application/rss+xml" title="Magento DevDocs RSS" href="/feed.xml" />



<meta name="google-site-verification" content="3WFsoYwBe6UuxDwgs7bmd7t0YFQVzDpLpWLjNh0CUp8" />

	<script>
  var baseUrl = "/devdocs-archive/2.2";
  var algolia = {
    id : "E642SEDTHL",
    index:  "devdocs",
    key:  "d2d0f33ab73e291ef8d88d8b565e754c",
  };

  var indices = [
    {
      label: "DevDocs",
      name: "devdocs",
      facetFilters: [["guide_version: 2.2", "versionless: true"]],
      refinements: [
        {
          label: "Functional areas",
          attribute: "functional_areas"
        }
      ],
      baseUrl: "https://devdocs.magento.com"
    },
    {
      label: "User Guide",
      name: "merchdocs_ee",
      baseUrl: "https://docs.magento.com/m2/ee/user_guide"
    },
    {
      label: "MBI User Guide",
      name: "merchdocs-mbi",
      baseUrl: "https://docs.magento.com/mbi"
    },
    {
      label: "Marketplace User Guide",
      name: "merchdocs-marketplace",
      baseUrl: "https://docs.magento.com/marketplace/user_guide"
    },
    {
      label: "PWA",
      name: "pwa-devdocs",
      baseUrl: "https://magento.github.io/pwa-studio"
    },
    {
      label: "Order Management",
      name: "oms-en",
      baseUrl: "https://omsdocs.magento.com"
    }
  ];
</script>




	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
	<link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
	<link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>
<body class="layout-default">


	<header class="site-header">
		

<nav class="site-nav">

  <div class="nav-container">

    <div class="menu-btn">
      <button id="menu-btn" class="menu-trigger menu-icon" aria-haspopup="true" aria-controls="nav-main" aria-label="Menu"></button>
    </div>

    <a class="logo" href="/devdocs-archive/2.2/">
      <img src="/devdocs-archive/2.2/assets/i/m-logo.svg" alt=""><img src="/devdocs-archive/2.2/assets/i/magento-logo.svg" alt="Magento" class="magento-logo" />
      <span class="site-logo">DevDocs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      



      <!-- Main Navigation --><ul class="nav-main" role="menubar"><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Cloud</span><div class="nav-popup"><div class="nav-section">
              <div class="nav-section-title">Cloud basics</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/bk-cloud.html">Cloud Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/architecture/cloud-architecture.html">Cloud Architecture</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-upgrade-parent.html">Upgrades and Patches</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/release-notes/cloud-tools.html">Release Notes</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">Cloud development</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/setup/first-time-setup.html">Local development</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/docker/docker-config.html">Launch Docker</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/docker/docker-quick-reference.html">Docker quick reference</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/environments.html">Configure Environments</a></li></ul>
            </div></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Setup</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/install-gde/bk-install-guide.html">Installation Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/extensions/">Magento Extensions Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/comp-mgr/bk-compman-upgrade-guide.html">Software Update Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/config-guide/bk-config-guide.html">Configuration Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/performance-best-practices/introduction.html">Performance Best Practices</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/migration/bk-migration-guide.html">Migration Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/release-notes/bk-release-notes.html">Release Information</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/reference/cli/magento.html">Command-line Tools Reference</a></li></ul></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Development</span><div class="nav-popup"><div class="nav-section">
              <div class="nav-section-title">Backend</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/architecture/bk-architecture.html">Architecture</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/extension-dev-guide/bk-extension-dev-guide.html">PHP Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/ext-best-practices/bk-ext-best-practices.html">Extension Developer Best Practices</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/mrg/intro.html">Module Reference Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/coding-standards/bk-coding-standards.html">Coding Standards</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/contributor-guide/contributing.html">Contributor Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">Frontend</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/frontend-dev-guide/bk-frontend-dev-guide.html">Frontend Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/ui_comp_guide/bk-ui_comps.html">UI Components Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/javascript-dev-guide/bk-javascript-dev-guide.html">JavaScript Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/pattern-library/bk-pattern.html">Admin Design Pattern Library</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/design-styleguide/bk-styleguide.html">Admin Style Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">API</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/get-started/bk-get-started-api.html">Get Started with Magento Web APIs</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/rest/bk-rest.html">REST API Reference</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/soap/bk-soap.html">SOAP API Reference</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/marketplace/eqp/v1/api.html">Marketplace EQP API Reference</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/mbi/docs/getting-started.html">Business Intelligence API</a></li></ul>
            </div></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Testing</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/test/testing.html">Magento Testing Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/mftf/docs/introduction.html">Functional Acceptance Testing (MFTF)</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/mtf/mtf_introduction.html">Functional Testing</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/test/integration/integration_test_execution.html">Integration Testing</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/test/js/jasmine.html">JavaScript Unit Testing</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/test/unit/unit_test_execution.html">PHP Unit Testing</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/get-started/web-api-functional-testing.html">Web API Functional Testing</a></li></ul></div></li><li class="nav-main-separator"></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Functional Areas</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/advanced-reporting/overview.html">Advanced Reporting</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/b2b/bk-b2b.html">B2B</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/howdoi/checkout/checkout_overview.html">Checkout</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/compliance/industry-compliance.html">Compliance</a></li><li class="" role="menuitem"><a href="http://omsdocs.magento.com/en/">Order Management</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/payments-integrations/bk-payments-integrations.html">Payment Integrations</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/extension-dev-guide/staging.html">Staging</a></li></ul></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Tutorials</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/rest/tutorials/index.html">Rest Tutorials</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/howdoi/customize_product.html">Customize Product Creation Form</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/howdoi/checkout/checkout_overview.html">Customize Checkout</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/community/resources/support.html">Magento Support</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/videos/">Video Tutorials</a></li></ul></div></li></ul><!-- /.nav-main -->

    </div>

    <div class="nav-actions">
      
<div class="app-switcher">
  <div class="dropdown">
    <button id="app-switcher-trigger" class="app-switcher-trigger" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="Documentation sites"></button>
    <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="app-switcher-trigger" role="menu">
      <div class="app-switcher-content">
      
      <div class="app-switcher-group">
        <h3 class="app-swither-group-title">Developer</h3>
        
        <li role="menuitem"><a class="dropdown-item" href="https://devdocs.magento.com/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Commerce Developer Documentation">Commerce Developer Documentation</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="http://pwastudio.io/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=PWA Studio">PWA Studio</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="https://omsdocs.magento.com/en/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Order Management">Order Management</a></li>
        
      </div>
      
      <div class="app-switcher-group">
        <h3 class="app-swither-group-title">Merchant</h3>
        
        <li role="menuitem"><a class="dropdown-item" href="https://docs.magento.com/m2/ee/user_guide/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Commerce User Guide">Commerce User Guide</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="https://omsdocs.magento.com/en/userguides/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Order Management">Order Management</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="https://docs.magento.com/mbi/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Business Intelligence">Business Intelligence</a></li>
        
        <li role="menuitem"><a class="dropdown-item" href="https://docs.magento.com/marketplace/user_guide/getting-started.html?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Marketplace">Marketplace</a></li>
        
      </div>
      
      </div>
    </ul>
  </div>
</div>


      <div class="search-btn">
        <button class="search-trigger search-icon" aria-label="Search"></button>
      </div>

      <form class="quick-search" action="/devdocs-archive/2.2/search.html" method="get" novalidate="novalidate">
        <input type="search" name="query" placeholder="Search" />
        <button class="quick-search-close" aria-label="Close Search">&times;</button>
      </form>

    </div>

  </div>

</nav><!-- #site-nav -->
<div class="nav-main-fader"></div>

	</header>

	<div class="global-wrapper">
		
		<div class="main-container">
			<a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
	<button class="toc-toggler">Table of Contents</button>
	<div class="sidebar-wrapper">

		

		<h4 class="guide-title">Magento Commerce Cloud</h4>
		<div class="collapsible-navigation">
		    <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/bk-cloud.html">Overview</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/onboarding/onboarding-tasks.html">Onboarding tasks</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/architecture/cloud-architecture.html">Architecture</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/basic-information/starter-architecture.html">Starter architecture</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/basic-information/starter-develop-deploy-workflow.html">Starter develop and deploy workflow</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/architecture/pro-architecture.html">Pro architecture</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/architecture/pro-develop-deploy-workflow.html">Pro develop and deploy workflow</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/architecture/scaled-architecture.html">Scaled architecture</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/requirements/cloud-requirements.html">Technologies and requirements</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/reference/cloud-composer.html">Composer</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/reference/cli-ref-topic.html">Magento Cloud CLI</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/reference/ece-tools-reference.html">ece-tools package</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/reference/git-integration.html">Git</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/environments-ssh.html">SSH and sFTP</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/new-relic.html">New Relic</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-integrate-blackfire.html">Blackfire.io</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/sendgrid.html">SendGrid</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/setup/first-time-setup.html">Local development setup</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/before/before-workspace.html">Prepare for manual setup</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/before/before-workspace-magento-prereqs.html">Install Magento prerequisites</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/before/before-workspace-ssh.html">Enable SSH keys</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/before/before-workspace-file-sys-owner.html">Set up the Magento file system owner</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/before/before-setup-env-2_clone.html">Clone and branch the project</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/before/before-setup-env-install.html">Install Magento</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/setup/first-time-deploy.html">First time deployment</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/howtos/debug.html">Optional - Configure Xdebug</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/howtos/sample-data.html">Optional - Install sample data</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/docker/docker-development.html">Docker development</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/docker/docker-config.html">Launch Docker</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/docker/docker-development-debug.html">Configure Xdebug for Docker</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/docker/docker-database.html">Connect to the database</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/docker/docker-development-testing.html">Functional testing in Docker</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/docker/docker-quick-reference.html">Docker quick reference</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/integrations/cloud-integrations.html">Integrations</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/integrations/bitbucket-integration.html">Bitbucket integration</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/integrations/github-integration.html">GitHub integration</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/integrations/health-notifications.html">Health notifications</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/setup/first-time-setup-import-first-steps.html">Import existing code into a project</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/setup/first-time-setup-import-prepare.html">Prepare your existing Magento Commerce system</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/setup/first-time-setup-import-import.html">Import Magento Commerce code</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/configure/configuration-overview.html">Configure your store</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/configure/configure-best-practices.html">Best practices for store configuration</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/live/paypal-onboarding.html">Set up PayPal</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/configure/setup-b2b.html">Set up Magento B2B</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/configure/setup-cron-jobs.html">Set up cron jobs</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-multi-sites.html">Set up multiple Cloud websites or stores</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/howtos/install-components.html">Install, manage, and upgrade modules</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/howtos/custom-theme.html">Install a theme</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/configure/import-url-rewrites.html">Import URL Rewrites</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/cdn/cloud-fastly.html">Configure Fastly services</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/cdn/configure-fastly.html">Set up Fastly</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/cdn/cloud-fastly-custom-response.html">Customize error and maintenance pages</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/cdn/fastly-waf-service.html">Web Application Firewall</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/cdn/fastly-image-optimization.html">Image Optimization</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/cdn/cloud-vcl-custom-snippets.html">Custom VCL snippets</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/cdn/fastly-vcl-wordpress.html">Reroute requests to a CMS backend</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/cdn/fastly-vcl-badreferer.html">Block referral spam</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/cdn/fastly-vcl-whitelist.html">Secure access to the Magento Admin UI</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/cdn/fastly-vcl-blocking.html">Custom VCL for blocking</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/cdn/trouble-fastly.html">Fastly troubleshooting</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/environments.html">Configure environments</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-conf-files_magento-app.html">Application</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/set-cache.html">Set cache for static files</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/magento-env-yaml.html">Build and deploy</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/setup-notifications.html">Set up notifications</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/log-handlers.html">Logging handlers</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/variables-intro.html">Environment variables</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/environment-vars_magento.html">ADMIN variables</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/variables-global.html">Global variables</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/variables-build.html">Build variables</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/variables-cloud.html">Cloud variables</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/variables-deploy.html">Deploy variables</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/variables-post-deploy.html">Post-deploy variables</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/working-with-variables.html">Working with variables</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-conf-files_routes.html">Routes</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-routes-more-cache.html">Caching</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-routes-more-redir.html">Redirects</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-routes-more-ssi.html">Server side includes</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-conf-files_services.html">Services</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-conf-files_services-mysql.html">Set up MySQL service</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-conf-files_services-redis.html">Set up Redis service</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-conf-files_services-elastic.html">Set up Elasticsearch service</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-conf-files_services-rabbit.html">Set up RabbitMQ service</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/restore-environment.html">Restore an environment</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/live/sens-data-over.html">Configuration management for store settings</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/live/sens-data-initial.html">Example of managing system-specific settings</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/projects.html">Manage your project</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-webint-basic.html">Configure your project</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-start.html">Project structure</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/log-locations.html">Log locations</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/user-admin.html">Create and manage users</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-webint-branch.html">Manage branches with the Interface</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/env/environments-start.html">Manage branches with the CLI</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/profile-database-queries.html">Profile database queries</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/manage-disk-space.html">Manage disk space</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/monitor-performance.html">Monitor performance</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-webint-snap.html">Snapshots and backup management</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/deploy/optimize-cloud-deployment.html">Optimize deployment</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/deploy/cloud-deployment-process.html">Cloud deployment process</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/deploy/reduce-downtime.html">Zero downtime deployment</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/deploy/static-content-deployment.html">Static content deployment</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/deploy/smart-wizards.html">Smart wizards</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/live/stage-prod-live.html">Deploy your store</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/reference/discover-deploy.html">Deployment process</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/deploy/continuous-deployment.html">Continuous deployment</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/live/live-prot.html">Protective block</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/live/live-sanity-check.html">Build and deploy on local</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/live/stage-prod-migrate-prereq.html">Prepare to deploy to Staging and Production</a></li><li class="active" role="menuitem"><a href="/devdocs-archive/2.2/cloud/live/stage-prod-migrate.html">Deploy code and migrate static files and data</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/live/stage-prod-test.html">Test deployment</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/live/live.html">Go live and launch</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/live/go-live-checklist.html">Go live checklist</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/live/launch-steps.html">Launch steps</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/trouble.html">Troubleshooting</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/troubleshoot-deployment.html">Troubleshoot deployment</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/trouble_ce-creds.html">Incorrect credentials</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/trouble_proj-startover.html">Resolve issues with a new project</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/trouble_comp-deploy-fail.html">Component deployment failure</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/reset-cron-jobs.html">Reset cron jobs</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/trouble-crypt-key-variable.html">Resolve issues with encryption key</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/trouble-error-html-minification.html">Resolve issues with HTML minification</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/trouble-google-analytics-deploy.html">Resolve issues with Google Analytics during deployment</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/restore-configuration-files.html">Restore configuration files</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/site-availability.html">Site availability</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/robots-sitemap.html">Add site map and search engine robots</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/trouble/theme-troubleshooting.html">Theme troubleshooting</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-upgrade-parent.html">Upgrades and patches</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/ece-tools-upgrade-project.html">Upgrade to use ece-tools</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/ece-tools-update.html">Update ece-tools version</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-patch.html">Apply custom patches</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/project/project-upgrade.html">Upgrade Magento version</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs-archive/2.2/cloud/release-notes/cloud-tools.html">Release notes</a></li></ul>
		</div>

	</div>

</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<!-- page-header -->
<section class="page-intro">








<h1 class="page-heading">Deploy code and migrate static files and data</h1>
</section>

			<p class="ref-header">Previous step</p>

<p><a href="/devdocs-archive/2.2/cloud/live/stage-prod-migrate-prereq.html">Prepare to deploy to Staging and Production</a></p>

<p>To migrate your database and static files to Staging and Production:</p>

<ul>
  <li><a href="#code">Deploy code</a></li>
  <li><a href="#cloud-live-migrate-static">Migrate static files</a></li>
  <li><a href="#cloud-live-migrate-db">Migrate the database</a></li>
</ul>

<p>If you encounter errors or need to change project configuration, complete the required updates in your local environment. Then, push the code changes to the Integration environment to deploy and test before pushing to Staging and Production environments.</p>

<h2 id="code">Deploy code to Staging and Production</h2>

<p>You can use the <a href="#interface">Project Web Interface</a> or <a href="#ssh">SSH and CLI commands</a> to deploy your code to Staging and Production.</p>

<h3 id="interface">Deploy code with the Project Web Interface</h3>

<p>The Project Web Interface provides features to create, manage, and deploy code in Integration, Staging, and Production environments for Starter and Pro plans.</p>

<p>For Pro projects, deploy the Integration branch you created to Staging and Production:</p>

<ol>
  <li><a href="https://accounts.magento.cloud">Log in</a> to your project.</li>
  <li>Select the Integration branch.</li>
  <li>Select the <strong>Merge</strong> option to deploy to Staging. Complete all testing.</li>
  <li>Select the Staging branch.</li>
  <li>Select the <strong>Merge</strong> option to deploy to Production.</li>
</ol>

<p>For Starter, deploy the development branch you created to Staging and Production:</p>

<ol>
  <li><a href="https://accounts.magento.cloud">Log in</a> to your project.</li>
  <li>Select the prepared code branch.</li>
  <li>Select the <strong>Merge</strong> option to deploy to Staging. Complete all testing.</li>
  <li>Select the Staging branch.</li>
  <li>Select the <strong>Merge</strong> option to deploy to Production.</li>
</ol>

<p><img src="/devdocs-archive/2.2/common/images/cloud_project-merge.png" alt="Use the merge option to deploy" /></p>

<h3 id="ssh">Deploy code with SSH and CLI</h3>

<p>You can use the <a href="/devdocs-archive/2.2/cloud/reference/cli-ref-topic.html">Magento Cloud CLI commands</a> to deploy code to Starter and Pro environments. You need SSH and Git access to your project. See <a href="/devdocs-archive/2.2/cloud/live/stage-prod-migrate-prereq.html">prepare for deployment</a>.</p>

<p><strong>Prerequisites:</strong></p>

<ul>
  <li><a href="/devdocs-archive/2.2/cloud/live/live-sanity-check.html">Build and deploy on local</a></li>
  <li><a href="/devdocs-archive/2.2/cloud/live/stage-prod-migrate-prereq.html">Prepare to deploy to Staging and Production</a></li>
</ul>

<h4 id="step-1--deploy-and-test-the-integration-environment">Step 1:  Deploy and test the Integration environment:</h4>

<ol>
  <li>
    <p>After logging into the project, check out the Integration environment:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>magento-cloud environment:checkout &lt;environment-ID&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Synchronize your local Integration environment with the remote environment:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>magento-cloud environment:synchronize &lt;environment-ID&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Create a snapshot of the environment as a backup:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>magento-cloud snapshot: create <span class="nt">-e</span> &lt;environment-ID&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Update code in your local branch as needed.</p>
  </li>
  <li>
    <p>Add, commit, and push changes to the environment.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>git add <span class="nt">-A</span> <span class="o">&amp;&amp;</span> git commit <span class="nt">-m</span> <span class="s2">"Commit message"</span> <span class="o">&amp;&amp;</span> git push magento &lt;environment-ID&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Complete site testing.</p>
  </li>
</ol>

<h4 id="step-2-merge-changes-to-staging-and-deploy">Step 2: Merge changes to Staging and deploy</h4>

<ol>
  <li>
    <p>Check out the Staging environment:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>magento-cloud environment:checkout &lt;environment-ID&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Synchronize your local Staging environment with the remote environment:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>magento-cloud environment:synchronize &lt;environment-ID&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Create a snapshot of the environment as a backup:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>magento-cloud snapshot: create <span class="nt">-e</span> &lt;environment-ID&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Merge the Integration environment to Staging to deploy:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>magento-cloud environment:merge &lt;Integration-ID&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Complete site testing.</p>
  </li>
</ol>

<h4 id="step-3-deploy-to-production">Step 3: Deploy to Production:</h4>

<ol>
  <li>
    <p>Check out, synchronize, and create a snapshot of your local Production environment.</p>
  </li>
  <li>
    <p>Merge the Staging environment to Production to deploy:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>magento-cloud environment:merge &lt;Staging-ID&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Complete site testing.</p>
  </li>
</ol>

<h2 id="cloud-live-migrate-static">Migrate static files</h2>

<p>You migrate <a href="https://glossary.magento.com/static-files">static files</a> from your <code class="language-plaintext highlighter-rouge">pub/media</code> directory to Staging or Production.</p>

<p>We recommend using the Linux remote synchronization and file transfer command <a href="https://en.wikipedia.org/wiki/Rsync"><code class="language-plaintext highlighter-rouge">rsync</code></a>. The rsync utility uses an algorithm that minimizes the amount of data by moving only the portions of files that have changed. Rsync also supports compression.</p>

<p>Use the following command to migrate files:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>rsync <span class="nt">-azvP</span> &lt;<span class="nb">source</span><span class="o">&gt;</span> &lt;destination&gt;
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This command uses the following options:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">a</code>–archive</li>
  <li><code class="language-plaintext highlighter-rouge">z</code>–compress</li>
  <li><code class="language-plaintext highlighter-rouge">v</code>–verbose</li>
  <li><code class="language-plaintext highlighter-rouge">P</code>–partial progress</li>
</ul>

<p>For additional options, see the <a href="http://linux.die.net/man/1/rsync">rsync man page</a>.</p>

<p>To migrate static files from your local machine, use the <code class="language-plaintext highlighter-rouge">rsync</code> command to copy the <code class="language-plaintext highlighter-rouge">pub/media</code> directory from your local Magento server to staging or production:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>rsync <span class="nt">-azvP</span> local_machine/pub/media/ &lt;environment_ssh_link@ssh.region.magento.cloud&gt;:pub/media/
</pre></td></tr></tbody></table></code></pre></div></div>

<p class="procedure">To migrate static files from remote-to-remote environments directly (fast approach):</p>

<p class="bs-callout-info">To transfer media from remote-to-remote environments directly, you must enable ssh agent forwarding, see <a href="https://developer.github.com/v3/guides/using-ssh-agent-forwarding/">GitHub guidance</a>.</p>

<ol>
  <li>
    <p><a href="/devdocs-archive/2.2/cloud/env/environments-ssh.html#ssh">Open an SSH connection</a> to the source environment.</p>

    <p>To find the <strong>SSH access</strong> link in your Project Web Interface, select the environment and click <strong>Access Site</strong>:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> ssh <span class="nt">-A</span> &lt;environment_ssh_link@ssh.region.magento.cloud&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Use the <code class="language-plaintext highlighter-rouge">rsync</code> command to copy the <code class="language-plaintext highlighter-rouge">pub/media</code> directory from your current environment to  another remote environment:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>rsync <span class="nt">-azvP</span> pub/media/ &lt;destination_environment_ssh_link@ssh.region.magento.cloud&gt;:pub/media/
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<h2 id="cloud-live-migrate-db">Migrate the database</h2>

<p><strong>Prerequisite:</strong> A database dump (see Step 3) should include database triggers. For dumping them, confirm you have the <a href="https://dev.mysql.com/doc/refman/5.7/en/privileges-provided.html#priv_trigger">TRIGGER privilege</a>.</p>

<p><strong>Important:</strong> The Integration environment database is strictly for development testing and can include data that you do not want to migrate into Staging and Production.</p>

<p>For continuous integration deployments, we <strong>do not recommend</strong> migrating data from Integration to Staging and Production. You could pass testing data or overwrite important data. Any vital configurations will be passed using the <a href="/devdocs-archive/2.2/cloud/live/sens-data-over.html">configuration file</a> and <code class="language-plaintext highlighter-rouge">setup:upgrade</code> command during build and deploy.</p>

<p>We <strong>do recommend</strong> migrating data from Production into Staging to fully test your site and store(s) in a near-production environment with all services and settings.</p>

<p class="bs-callout-info">To transfer media from remote-to-remote environments directly you must enable ssh agent forwarding, see <a href="https://developer.github.com/v3/guides/using-ssh-agent-forwarding/">GitHub guidance</a></p>

<p class="procedure">To migrate a database:</p>

<ol>
  <li>
    <p>SSH into the environment you want to create a database dump from:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>ssh <span class="nt">-A</span> &lt;environment_ssh_link@ssh.region.magento.cloud&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>List the environment relationships to find the database login information:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>php <span class="nt">-r</span> <span class="s1">'print_r(json_decode(base64_decode($_ENV["MAGENTO_CLOUD_RELATIONSHIPS"]))-&gt;database);'</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Create a database dump file in `gzip format:</p>

    <p>For Starter environments and Pro Integration environments:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>mysqldump <span class="nt">-h</span> &lt;database host&gt; <span class="nt">--user</span><span class="o">=</span>&lt;database username&gt; <span class="nt">--password</span><span class="o">=</span>&lt;password&gt; <span class="nt">--single-transaction</span> <span class="nt">--triggers</span> main | <span class="nb">gzip</span> - <span class="o">&gt;</span> /tmp/database.sql.gz
</pre></td></tr></tbody></table></code></pre></div>    </div>

    <p>For Pro Staging and Production environments, the name of the database is in the <code class="language-plaintext highlighter-rouge">MAGENTO_CLOUD_RELATIONSHIPS</code> variable (typically the same as the application name and username):</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>mysqldump <span class="nt">-h</span> &lt;database host&gt; <span class="nt">--user</span><span class="o">=</span>&lt;database username&gt; <span class="nt">--password</span><span class="o">=</span>&lt;password&gt; <span class="nt">--single-transaction</span> <span class="nt">--triggers</span> &lt;database name&gt; | <span class="nb">gzip</span> - <span class="o">&gt;</span> /tmp/database.sql.gz
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Transfer the database dump to another remote environment with an <code class="language-plaintext highlighter-rouge">rsync</code> command:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>rsync <span class="nt">-azvP</span> /tmp/database.sql.gz &lt;destination_environment_ssh_link@ssh.region.magento.cloud&gt;:/tmp
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Enter <code class="language-plaintext highlighter-rouge">exit</code> to terminate the SSH connection.</p>
  </li>
  <li>
    <p>Open an SSH connection to the environment you want to migrate the database into:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>ssh <span class="nt">-A</span> &lt;destination_environment_ssh_link@ssh.region.magento.cloud&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>Import the database dump:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>zcat /tmp/database.sql.gz | mysql <span class="nt">-h</span> &lt;database_host&gt; <span class="nt">-u</span> &lt;username&gt; <span class="nt">-p</span>&lt;password&gt; &lt;database name&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>

    <p>The following example references the gzip file created by the database dump operation:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>zcat /tmp/database.sql.gz | mysql <span class="nt">-h</span> database.internal <span class="nt">-u</span> user main
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<h3 id="troubleshooting-the-database-migration">Troubleshooting the database migration</h3>

<p>If you encounter the following error, you can try to create a database dump with the DEFINER replaced:</p>

<div class="language-terminal no-copy highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">ERROR 1277 (42000) at line &lt;number&gt;</span>: Access denied<span class="p">;</span> you need <span class="o">(</span>at least one of<span class="o">)</span> the SUPER privilege<span class="o">(</span>s<span class="o">)</span> <span class="k">for </span>this operation
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This error occurs because the DEFINER for the triggers in the SQL dump is the production user. This user requires administrative permissions.</p>

<p>To solve this problem, you can generate a new database dump changing or removing the <code class="language-plaintext highlighter-rouge">DEFINER</code> clause as shown in the following example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>mysqldump <span class="nt">-h</span> &lt;database host&gt; <span class="nt">--user</span><span class="o">=</span>&lt;database username&gt; <span class="nt">--password</span><span class="o">=</span>&lt;password&gt; <span class="nt">--single-transaction</span> main  | <span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'s/DEFINER[ ]*=[ ]*[^*]*\*/\*/'</span> | <span class="nb">gzip</span> <span class="o">&gt;</span> /tmp/database_no-definer.sql.gz
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Use the database dump file to <a href="#cloud-live-migrate-db">migrate the database</a>.</p>

<p class="bs-callout-info">After migrating the database, you can set up your stored procedures or views in Staging or Production the same way you did in your Integration environment.</p>

<p class="ref-header">Related topics</p>

<p><a href="/devdocs-archive/2.2/cloud/live/stage-prod-test.html">Test deployment</a></p>

			
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

  
  <div class="page-updated">
    <img src="/devdocs-archive/2.2/i/icons/time.svg" alt="Updated" />
    <time id="last-modified-at" itemprop="dateModified" datetime="2019-12-12">
      Dec 12th, 2019
    </time>
  </div>
  

  

  

  

</div>


	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->


	</div>
	<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      

<ul class="nav footer-links" role="menu">

  <li class="" role="menuitem"><a href="https://github.com/magento/devdocs/blob/master/.github/CONTRIBUTING.md">Become a Contributor</a></li>

  <li class="" role="menuitem"><a href="https://glossary.magento.com/">Glossary</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/terms/privacy/">Privacy Policy</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/terms/">Terms of Service</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/licensing/">License/Trademark FAQ</a></li>

  <li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/release-notes/bk-release-notes.html">Release Notes</a></li>

  <li class="" role="menuitem"><a href="/devdocs-archive/2.2/guides/v2.2/release-notes/packages-open-source.html">Third-Party Licenses</a></li>

</ul>

    </div>

		<div class="copyright-date">&copy; 2023 Magento. All rights reserved.</div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/devdocs-archive/2.2/assets/js/app.min.js?ver=7"></script>





<script type="text/javascript" src="/devdocs-archive/2.2/common/js/last-modified-at.js"></script>
<script type="text/javascript" src="/devdocs-archive/2.2/common/js/glossary-link-enhancer.js"></script>


</body>
</html>

