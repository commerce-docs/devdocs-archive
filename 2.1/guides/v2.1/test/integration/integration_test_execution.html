<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>Running Integration Tests | Archived Magento 2.1 Developer Documentation</title>
	<meta name="description" content="Archived Magento 2.1.18 Developer Documentation.">

	<link rel="stylesheet" href="/devdocs-archive/2.1/assets/css/app.css" />
	<link rel="stylesheet" href="/devdocs-archive/2.1/assets/css/print.css" media="print"/>

	<link rel="stylesheet" href="/devdocs-archive/2.1/common/css/devdocs.css" />
<link rel="alternate" type="application/rss+xml" title="Magento DevDocs RSS" href="/feed.xml" />



	<script>
  var baseUrl = "/devdocs-archive/2.1";
  var algolia = {
    id : "",
    index:  "",
    key:  "",
    facetFilters: [["guide_version: 2.1", "versionless: true"]]
  };
</script>




	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
	<link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
	<link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>
<body class="layout-default">

	<header class="site-header">

		<nav class="site-nav">

  <div class="menu-btn">
    <button id="menu-btn" class="menu-trigger menu-icon" aria-haspopup="true" aria-controls="nav-main" aria-label="Menu"></button>
  </div>

  <div class="nav-container">

    <a class="logo" href="/devdocs-archive/2.1/">
      <img src="/devdocs-archive/2.1/assets/i/m-logo.svg" alt=""><img src="/devdocs-archive/2.1/assets/i/magento-logo.svg" alt="Magento" class="magento-logo" />
      <span class="site-logo">DevDocs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      


<div class="version-switcher dropdown">
	<button class="btn dropdown-toggle" disabled>
		Magento 2.1
	</button>
</div>


      <!-- Main Navigation --><ul class="nav-main" role="menubar"><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Cloud</span><div class="nav-popup"><div class="nav-section">
              <div class="nav-section-title">Cloud basics</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/cloud/bk-cloud.html">Cloud Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/cloud/architecture/cloud-architecture.html">Cloud Architecture</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/cloud/project/project-upgrade-parent.html">Upgrades and Patches</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/cloud/release-notes/cloud-tools.html">Release Notes</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">Cloud development</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/cloud/setup/first-time-setup.html">Local development</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/cloud/docker/docker-config.html">Launch Docker</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/cloud/docker/docker-quick-reference.html">Docker quick reference</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/cloud/env/environments.html">Configure Environments</a></li></ul>
            </div></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Setup</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/install-gde/bk-install-guide.html">Installation Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/extensions/">Magento Extensions Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/comp-mgr/bk-compman-upgrade-guide.html">Component Manager and System Upgrade Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/config-guide/bk-config-guide.html">Configuration Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/migration/bk-migration-guide.html">Migration Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/release-notes/bk-release-notes.html">Release Information</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/reference/cli/magento.html">Command-line Tools Reference</a></li></ul></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Development</span><div class="nav-popup"><div class="nav-section">
              <div class="nav-section-title">Backend</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/architecture/bk-architecture.html">Architecture</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/extension-dev-guide/bk-extension-dev-guide.html">PHP Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/ext-best-practices/bk-ext-best-practices.html">Extension Developer Best Practices</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/mrg/intro.html">Module Reference Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/coding-standards/bk-coding-standards.html">Coding Standards</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/contributor-guide/contributing.html">Contributor Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">Frontend</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/frontend-dev-guide/bk-frontend-dev-guide.html">Frontend Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/ui_comp_guide/bk-ui_comps.html">UI Components Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/javascript-dev-guide/bk-javascript-dev-guide.html">JavaScript Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/pattern-library/bk-pattern.html">Admin Design Pattern Library</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/design-styleguide/bk-styleguide.html">Admin Style Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">API</div>
              <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/get-started/bk-get-started-api.html">Get Started with Magento Web APIs</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/rest/bk-rest.html">REST API Reference</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/soap/bk-soap.html">SOAP API Reference</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/marketplace/eqp/api.html">Marketplace EQP API Reference</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/mbi/docs/getting-started.html">Business Intelligence Import API</a></li></ul>
            </div></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Testing</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/testing.html">Magento Testing Guide</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/mtf/mtf_introduction.html">Functional Testing</a></li><li class="active" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/integration/integration_test_execution.html">Integration Testing</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/js/jasmine.html">JavaScript Unit Testing</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/unit/unit_test_execution.html">PHP Unit Testing</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/get-started/web-api-functional-testing.html">Web API Functional Testing</a></li></ul></div></li><li class="nav-main-separator"></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Functional Areas</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/howdoi/checkout/checkout_overview.html">Checkout</a></li><li class="" role="menuitem"><a href="http://omsdocs.magento.com/en/">Order Management</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/payments-integrations/bk-payments-integrations.html">Payment Integrations</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/extension-dev-guide/staging.html">Staging</a></li></ul></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Tutorials</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/rest/tutorials/index.html">Rest Tutorials</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/howdoi/customize_product.html">Customize Product Creation Form</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/howdoi/checkout/checkout_overview.html">Customize Checkout</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/community/resources/support.html">Magento Support</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/videos/">Video Tutorials</a></li></ul></div></li></ul><!-- /.nav-main -->

    </div>

  </div>

</nav><!-- #site-nav -->
<div class="nav-main-fader"></div>


	</header>

	<div class="global-wrapper">

		
    <div class="message-banner">
       <a href="http://devdocs.magento.com/guides/v2.1/release-notes/ReleaseNotes2.1.18CE.html" target="_blank">Magento 2.1.18</a> is the final 2.1.x release. After June 2019, Magento 2.1.x will no longer receive security patches, quality fixes, or documentation updates.</br>To maintain your site's performance, security, and PCI compliance, upgrade to the latest version of Magento.</a>
    </div>









		<div class="main-container">
			<a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
	<button class="toc-toggler">Table of Contents</button>
	<div class="sidebar-wrapper">

		

		<h4 class="guide-title">Testing</h4>
		<div class="collapsible-navigation">
		    <ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/testing.html">Introduction</a></li><li class="" role="menuitem"><span>Integration testing</span><ul><li class="active" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/integration/integration_test_execution.html">Running integration tests</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/integration/annotations.html">Using DocBlock annotations</a><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/integration/annotations/depends.html">@depends</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/integration/annotations/magento-app-area.html">@magentoAppArea</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/integration/annotations/magento-app-isolation.html">@magentoAppIsolation</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/integration/annotations/magento-cache.html">@magentoCache</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/integration/annotations/magento-components-dir.html">@magentoComponentsDir</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/integration/annotations/magento-config-fixture.html">@magentoConfigFixture</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/integration/annotations/magento-data-fixture.html">@magentoDataFixture</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/integration/annotations/magento-db-isolation.html">@magentoDbIsolation</a></li></ul></li></ul></li><li class="" role="menuitem"><span>JavaScript Unit Testing</span><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/js/jasmine.html">Jasmine</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/js/test_js-unit.html">JsTestDriver</a></li></ul></li><li class="" role="menuitem"><span>PHP Unit Testing</span><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/unit/unit_test_execution.html">Running Unit Tests</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/unit/unit_test_execution_cli.html">Running Unit Tests in CLI</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/unit/unit_test_execution_phpstorm.html">Running Unit Tests in PhpStorm</a></li><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/unit/writing_testable_code.html">Writing Testable Code</a></li><li class="" role="menuitem"><span>Using DocBlock annotations</span><ul><li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/test/unit/annotations/data-provider.html">@dataProvider</a></li></ul></li></ul></li></ul>
		</div>

	</div>

</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<!-- page-header -->
<section class="page-intro">
	

	

	<h1 class="page-heading">Running Integration Tests</h1>
</section>

			<p>Integration tests require the Magento runtime environment, so they need a little preparation before they can be executed.
Once the system is prepared, the tests can be executed using either the command line interface or within an IDE like PhpStorm.</p>

<h2 id="set-up-the-integration-test-framework">Set up the integration test framework</h2>

<p>In order to run the integration tests, create and configure a test database.
You might also want to adjust the PHPUnit configuration, depending on your requirements.</p>

<p>Refer to <a href="#setup">Preparing Integration Test Execution</a> for further information about setting up the test environment.</p>

<h2 id="command-line-interface-cli">Command Line Interface (CLI)</h2>

<p>This option can be used for running the tests locally during development or on remote servers during Continuous Integration.</p>

<p>Please refer to <a href="#cli-run">Running Integration Tests in the CLI</a> for further information.</p>

<h2 id="phpstorm-ide">PhpStorm IDE</h2>

<p>Running the integration tests inside an IDE like PhpStorm IDE is convenient during development. This is mostly used when writing a new integration test.</p>

<p>Other than convenience, there is no benefit over running the tests on the console.</p>

<p>Refer to <a href="/devdocs-archive/2.1/guides/v2.1/test/unit/unit_test_execution_phpstorm.html">Running Integration Tests in PhpStorm</a> for further information.</p>

<h2 id="setup">Prepare integration test execution</h2>

<p>Before the Magento integration test framework can be used, the test environment must be prepared.
These prerequisites are required:</p>

<ul>
  <li>A dedicated integration test database</li>
  <li>The test framework database configuration</li>
  <li>The PHPUnit configuration matches the purpose of the integration test execution</li>
</ul>

<h2 id="integration-test-database">Integration test database</h2>

<p>By default, for every integration test run, the test framework installs a fresh Magento test database.</p>

<p class="bs-callout bs-callout-warning">Do not use the same database as the real Magento instance. Any data (products, customers, orders, and everything else) will be lost!</p>

<p>For safety reasons it is recommended to use a dedicated database user for running the tests. That database user should not have access to any other databases.
Here are examples of SQL commands that create a test database and a dedicated test user account:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">magento_integration_tests</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">ON</span> <span class="n">magento_integration_tests</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'magento2_test_user'</span><span class="o">@</span><span class="s1">'localhost'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'ftYx4pm6^x9.&amp;^hB'</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Replace the example database and username, and the example password, with something that matches your requirements and conventions.</p>

<h3 id="configure-the-framework-to-use-the-test-database">Configure the framework to use the test database</h3>

<p>The Magento 2 integration test framework comes with a configuration file template, <code class="highlighter-rouge">mage2ce/dev/tests/integration/etc/install-config-mysql.php.dist</code>.</p>

<p>Copy this file to
<code class="highlighter-rouge">mage2ce/dev/tests/integration/etc/install-config-mysql.php</code>
(without the <code class="highlighter-rouge">.dist</code> suffix) and add your test database access credentials.</p>

<p>The contents will look something like the following. Use the DB access credentials for your test database instead of the example values below.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>

<span class="k">return</span> <span class="p">[</span>
    <span class="s1">'db-host'</span> <span class="o">=&gt;</span> <span class="s1">'localhost'</span><span class="p">,</span>
    <span class="s1">'db-user'</span> <span class="o">=&gt;</span> <span class="s1">'magento2_test_user'</span><span class="p">,</span>
    <span class="s1">'db-password'</span> <span class="o">=&gt;</span> <span class="s1">'ftYx4pm6^x9.&amp;^hB'</span><span class="p">,</span>
    <span class="s1">'db-name'</span> <span class="o">=&gt;</span> <span class="s1">'magento_integration_tests'</span><span class="p">,</span>
    <span class="s1">'db-prefix'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
    <span class="s1">'backend-frontname'</span> <span class="o">=&gt;</span> <span class="s1">'backend'</span><span class="p">,</span>
    <span class="s1">'admin-user'</span> <span class="o">=&gt;</span> <span class="err">\</span><span class="nc">Magento\TestFramework\Bootstrap</span><span class="o">::</span><span class="no">ADMIN_NAME</span><span class="p">,</span>
    <span class="s1">'admin-password'</span> <span class="o">=&gt;</span> <span class="err">\</span><span class="nc">Magento\TestFramework\Bootstrap</span><span class="o">::</span><span class="no">ADMIN_PASSWORD</span><span class="p">,</span>
    <span class="s1">'admin-email'</span> <span class="o">=&gt;</span> <span class="err">\</span><span class="nc">Magento\TestFramework\Bootstrap</span><span class="o">::</span><span class="no">ADMIN_EMAIL</span><span class="p">,</span>
    <span class="s1">'admin-firstname'</span> <span class="o">=&gt;</span> <span class="err">\</span><span class="nc">Magento\TestFramework\Bootstrap</span><span class="o">::</span><span class="no">ADMIN_FIRSTNAME</span><span class="p">,</span>
    <span class="s1">'admin-lastname'</span> <span class="o">=&gt;</span> <span class="err">\</span><span class="nc">Magento\TestFramework\Bootstrap</span><span class="o">::</span><span class="no">ADMIN_LASTNAME</span><span class="p">,</span>
<span class="p">];</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p class="bs-callout bs-callout-info">Leave all the settings that do not start with <code class="highlighter-rouge">db-</code> at their default values.</p>

<h2 id="adjust-the-phpunit-configuration-file">Adjust the PHPUnit configuration file</h2>

<p>The default integration test configuration can be found at <code class="highlighter-rouge">dev/tests/integration/phpunit.xml.dist</code>.</p>

<p>Without adjustments it will run all core integration tests, which is useful for example on a continuous integration server.</p>

<p>When making adjustments to the configuration, copy the default file to <code class="highlighter-rouge">dev/tests/integration/phpunit.xml</code> (again, without the <code class="highlighter-rouge">.dist</code> suffix) and make your changes there. That way, your changes will not be overwritten during Magento upgrades.</p>

<p>There are many settings in the file.
This guide will only describe three common adjustments.
Refer to the <a href="https://phpunit.de/manual/4.1/en/appendixes.configuration.html">PHPUnit documentation</a>, and the comments in the default file, for more information about the available configuration settings.</p>

<h3 id="tests_cleanup-constant">TESTS_CLEANUP constant</h3>

<p>Default value:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;const</span> <span class="na">name=</span><span class="s">"TESTS_CLEANUP"</span> <span class="na">value=</span><span class="s">"enabled"</span><span class="nt">/&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>If this constant is set to <code class="highlighter-rouge">enabled</code>, the integration test framework will clean the test database and reinstall Magento on every test run.
This way, any new modules will be automatically picked up, and any cruft that might have been left over from previous test runs will be removed.
It also causes the test framework to flush the test Magento configuration, the <a href="https://glossary.magento.com/cache">cache</a> and the code generation before executing any tests.</p>

<p>The downside of setting <code class="highlighter-rouge">TEST_CLEANUP</code> to <code class="highlighter-rouge">enabled</code> is that the reinstallation of Magento takes time (the exact time depends on the host you are using to run the integration tests and the Magento version.)</p>

<p>During the development of new integration tests, where only a subset of the tests is executed repeatedly, that overhead of setting up a fresh execution environment for each run quickly becomes a burden.</p>

<p>In that case the <code class="highlighter-rouge">TEST_CLEANUP</code> constant can be set to <code class="highlighter-rouge">disabled</code>.
The test execution will start much quicker, but as a consequence the developer must manually flush the cache and the database when needed.</p>

<p>The integration test framework creates the temporary test files beneath the directory
<code class="highlighter-rouge">dev/tests/integration/tmp/sandbox-*</code> (followed by a long hash ID).</p>

<p>To force the test framework to regenerate the cache and the other files, remove the directory:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">rm</span> <span class="nt">-r</span> dev/tests/integration/tmp/sandbox-<span class="k">*</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="php-memory_limit">PHP memory_limit</h3>

<p>The default <code class="highlighter-rouge">phpunit.xml.dist</code> file does not contain any PHP <code class="highlighter-rouge">memory_limit</code> settings.
However, sometimes the <a href="https://glossary.magento.com/php">PHP</a> configuration restricts the amount of memory PHP may consume.
This can make it impossible to run the integration tests.</p>

<p>The PHP memory limit can be turned off by adding the following configuration to the <code class="highlighter-rouge">&lt;php&gt;</code> section of the integration test <code class="highlighter-rouge">phpunit.xml</code> file:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;ini</span> <span class="na">name=</span><span class="s">"memory_limit"</span> <span class="na">value=</span><span class="s">"-1"</span><span class="nt">/&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="execute-third-party-integration-tests">Execute third party integration tests</h2>

<p>The Magento code integration tests reside in the directory <code class="highlighter-rouge">dev/tests/integration/testsuite</code>.
For core tests it makes sense that the integration tests do not reside within individual modules, because most integration test execute code from many different modules.</p>

<p>Specific integration tests for shop implementation could also be placed within a different subdirectory of <code class="highlighter-rouge">dev/tests/integration/testsuite</code>, and then would be executed together with the core tests.</p>

<p>However, third party Magento extensions are contained within a single directory, and might supply custom integration tests too.
These tests usually are placed in the <code class="highlighter-rouge">Test/Integration/</code> subdirectory within the <a href="https://glossary.magento.com/module">module</a> folder.</p>

<p>These third party integration tests are not picked up by the default integration test configuration.
A test suite configuration like the following can be added to the <code class="highlighter-rouge">&lt;testsuites&gt;</code> section of the <code class="highlighter-rouge">phpunit.xml</code> file so they are included during test execution.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;testsuite</span> <span class="na">name=</span><span class="s">"Third Party Integration Tests"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;directory&gt;</span>../../../app/code/*/*/Test/Integration<span class="nt">&lt;/directory&gt;</span>
    <span class="nt">&lt;directory&gt;</span>../../../vendor/*/module-*/Test/Integration<span class="nt">&lt;/directory&gt;</span>
    <span class="nt">&lt;exclude&gt;</span>../../../app/code/Magento<span class="nt">&lt;/exclude&gt;</span>
    <span class="nt">&lt;exclude&gt;</span>../../../vendor/magento<span class="nt">&lt;/exclude&gt;</span>
<span class="nt">&lt;/testsuite&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Such a test suite configuration can then be executed using the <code class="highlighter-rouge">--testsuite &lt;name&gt;</code> command option. For example, if you are in the <code class="highlighter-rouge">dev/tests/integration</code> directory:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>php ../../../vendor/bin/phpunit <span class="nt">--testsuite</span> <span class="s2">"Third Party Integration Tests"</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="cli-run">Run integration tests in the CLI</h2>

<p>Probably the most common way to execute integration tests is using the command line interface (CLI).</p>

<p>Ensure you have <a href="#setup">prepared the integration test environment</a> before starting.</p>

<p>The integration tests have to be executed with the current working directory being <code class="highlighter-rouge">dev/tests/integration</code>.
The test configuration resides in that directory and will be picked up by <code class="highlighter-rouge">phpunit</code> automatically, without the need to specify it as a command line option.</p>

<h3 id="run-all-integration-tests">Run all integration tests</h3>

<p>By default, if no additional arguments are specified, the test configuration executes all integration tests in the directory <code class="highlighter-rouge">dev/tests/integration/testsuite</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cd </span>dev/tests/integration
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>../../../vendor/bin/phpunit
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>Expected log</p>
</blockquote>

<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="go">PHPUnit 4.1.0 by Sebastian Bergmann.

Configuration read from /var/www/magento2/dev/tests/integration/phpunit.xml

</span><span class="c">..........................
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>The path to the <code class="highlighter-rouge">phpunit</code> executable installed by <a href="https://glossary.magento.com/composer">Composer</a> into the vendor directory is used.</p>

<h3 id="run-only-a-custom-testsuite">Run only a custom testsuite</h3>

<p>PHPUnit offers several ways to only execute a subset of tests.
For example, it is common to only execute a single test suite from the <code class="highlighter-rouge">phpunit.xml</code> configuration.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cd </span>dev/tests/integration
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>../../../vendor/bin/phpunit <span class="nt">--testsuite</span> <span class="s2">"Memory Usage Tests"</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="run-tests-from-a-specific-directory-tree">Run tests from a specific directory tree</h3>

<p>To execute only the tests within a specific directory (for example an extension), pass the path to that directory as an argument to <code class="highlighter-rouge">phpunit</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cd </span>dev/tests/integration
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>../../../vendor/bin/phpunit ../../../app/code/Acme/Example/Test/Integration
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="run-a-single-test-class">Run a single test class</h3>

<p>When developing a new integration test class, it is common to run only that single test many times.
Pass the path to the file containing the test class as an argument to <code class="highlighter-rouge">phpunit</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cd </span>dev/tests/integration
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>../../../vendor/bin/phpunit ../../../app/code/Acme/Example/Test/Integration/ExampleTest.php
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="run-a-single-test-within-a-test-class">Run a single test within a test class</h3>

<p>Running only a single test within a test class can be done by specifying the test class together with the <code class="highlighter-rouge">--filter</code> argument and the name to select the test currently being developed:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cd </span>dev/tests/integration
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>../../../vendor/bin/phpunit <span class="nt">--filter</span> <span class="s1">'testOnlyThisOneIsExecuted'</span> ../../../app/code/Acme/Example/Test/Integration/ExampleTest.php
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="common-mistakes">Common mistakes</h2>

<h3 id="can-not-read-files-specified-as-arguments">Can not read files specified as arguments</h3>

<p>This happens if the integration tests are executed from a wrong directory.</p>

<h3 id="could-not-read-devtestsintegrationphpunitxml">Could not read “dev/tests/integration/phpunit.xml”</h3>

<p>This error happens if the integration tests are executed from a different directory than <code class="highlighter-rouge">dev/tests/integration</code>.
To fix the issue, change into the <code class="highlighter-rouge">dev/tests/integration</code> directory and run the tests from there with any relative paths adjusted accordingly.</p>

<h3 id="unable-to-connect-to-mysql">Unable to connect to MySQL</h3>

<p>The <a href="https://glossary.magento.com/php">PHP</a> interpreter must be able to connect to the test database. By default, this means the tests have to run on the same host as the MySQL server.
This problem most commonly crops up during development with Vagrant or Docker, where the Magento DB is running on a virtual machine.
If the tests then are executed using a PHP interpreter on the host system, the database might not be accessible.</p>

<p>The error usually looks something like:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>phpunit
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>Expected log</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>exception <span class="s1">'PDOException'</span> with message <span class="s1">'SQLSTATE[HY000] [2002] No such file or directory'</span> <span class="k">in</span> /var/www/magento2/vendor/magento/zendframework1/library/Zend/Db/Adapter/Pdo/Abstract.php:129
</pre></td></tr></tbody></table></code></pre></div></div>

<p>There are many ways this problem can be resolved, but the easiest is to run the tests in the virtual machine as well.</p>

<h2 id="phpstorm-run">Run integration tests in PhpStorm</h2>

<p>When writing new integration tests or during debugging, it is convenient to execute tests from within the PhpStorm IDE.</p>

<p>Ensure you have <a href="#setup">prepared the integration test environment</a> before starting.</p>

<h3 id="create-an-integration-test-run-configuration">Create an integration test run configuration</h3>

<p>Setting up a run configuration for integration tests is very similar to creating a run configuration for unit tests.</p>

<p>Refer to <a href="/devdocs-archive/2.1/guides/v2.1/test/unit/unit_test_execution_phpstorm.html">Running Unit Tests in PhpStorm</a> for instructions about how to create a basic run configuration.
Then configure the integration test configuration file to be used.</p>

<h3 id="use-the-integration-test-configuration-file">Use the integration test configuration file</h3>

<p>The only difference in the run configuration is that the integration test <code class="highlighter-rouge">phpunit.xml.dist</code> or <code class="highlighter-rouge">phpunit.xml</code> configuration file from the directory <code class="highlighter-rouge">dev/tests/integration</code> has to be selected.</p>

<p><img src="/devdocs-archive/2.1/common/images/phpstorm_run_config_class_integration_tests.png" alt="Integration Test Class run configuration" width="600px" /></p>

<h2 id="integration-tests-file-structure">Integration tests file structure</h2>

<p>The root folder for the Magento integration tests suite —<code class="highlighter-rouge">&lt;magento_root&gt;/dev/tests/integration</code>—contains the following sub-folders and files:</p>

<p>This folder contains the following sub-folders and files:</p>

<ul>
  <li><code class="highlighter-rouge">framework/</code> – Integration testing framework scripts, configuration files and classes.</li>
  <li><code class="highlighter-rouge">Magento/</code> – A set of classes that implement the Magento integration tests framework.</li>
  <li><code class="highlighter-rouge">bootstrap.php</code> – The PHPUnit bootstrap script.</li>
  <li><code class="highlighter-rouge">etc/install-config-&lt;db_vendor&gt;.php</code> – A configuration file that provides values for installing the Magento application.</li>
  <li><code class="highlighter-rouge">testsuite/</code> – The test suite.</li>
  <li><code class="highlighter-rouge">tmp/</code> – A writable directory for storing temporary data during test execution.</li>
  <li><code class="highlighter-rouge">sandbox-&lt;hash&gt;/</code> – The folder where each Magento instance stores temporary and configuration data.</li>
  <li><code class="highlighter-rouge">phpunit.xml.dist</code> – A PHPUnit configuration file.</li>
</ul>

<!-- LINK DEFINITIONS -->


			
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

  
  <div class="page-updated">
    <img src="/devdocs-archive/2.1/i/icons/time.svg" alt="Updated" />
    <time id="last-modified-at" itemprop="dateModified" datetime="2019-05-31">
      May 31st, 2019
    </time>
  </div>
  

  
    <div class="page-contributor">
      <a href="http://vinaikopp.com/" target="_blank">
        Thanks to Vinai Kopp for contributing this topic
      </a>
    </div>
  


  

    

    

  

</div>


	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->


	</div>
	<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      

<ul class="nav footer-links" role="menu">

  <li class="" role="menuitem"><a href="https://github.com/magento/devdocs/blob/master/.github/CONTRIBUTING.md">Become a Contributor</a></li>

  <li class="" role="menuitem"><a href="https://glossary.magento.com/">Glossary</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/terms/privacy/">Privacy Policy</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/terms/">Terms of Service</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/licensing/">License/Trademark FAQ</a></li>

  <li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/release-notes/bk-release-notes.html">Release Notes</a></li>

  <li class="" role="menuitem"><a href="/devdocs-archive/2.1/guides/v2.1/release-notes/packages-open-source.html">Third-Party Licenses</a></li>

</ul>

    </div>

		<div class="copyright-date">&copy; 2023 Magento. All rights reserved.</div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/devdocs-archive/2.1/assets/js/app.min.js"></script>





<script type="text/javascript" src="/devdocs-archive/2.1/common/js/last-modified-at.js"></script>
<script type="text/javascript" src="/devdocs-archive/2.1/common/js/glossary-link-enhancer.js"></script>


</body>
</html>

