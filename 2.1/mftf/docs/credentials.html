<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>Credentials | Archived Magento 2.1 Developer Documentation</title>
	<meta name="description" content="Archived Magento 2.1.18 Developer Documentation.">

	<link rel="stylesheet" href="/devdocs/2.1/assets/css/app.css" />
	<link rel="stylesheet" href="/devdocs/2.1/assets/css/print.css" media="print"/>

	<link rel="stylesheet" href="/devdocs/2.1/common/css/devdocs.css" />
<link rel="alternate" type="application/rss+xml" title="Magento DevDocs RSS" href="/feed.xml" />



	<script>
  var baseUrl = "/devdocs/2.1";
  var algolia = {
    id : "",
    index:  "",
    key:  "",
    facetFilters: [["guide_version: 2.1", "versionless: true"]]
  };
</script>




	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
	<link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
	<link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>
<body class="layout-default">

	<header class="site-header">

		<nav class="site-nav">

  <div class="menu-btn">
    <button id="menu-btn" class="menu-trigger menu-icon" aria-haspopup="true" aria-controls="nav-main" aria-label="Menu"></button>
  </div>

  <div class="nav-container">

    <a class="logo" href="/devdocs/2.1/">
      <img src="/devdocs/2.1/assets/i/m-logo.svg" alt=""><img src="/devdocs/2.1/assets/i/magento-logo.svg" alt="Magento" class="magento-logo" />
      <span class="site-logo">DevDocs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      



      <!-- Main Navigation --><ul class="nav-main" role="menubar"><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Cloud</span><div class="nav-popup"><div class="nav-section">
              <div class="nav-section-title">Cloud basics</div>
              <ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/bk-cloud.html">Cloud Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/architecture/cloud-architecture.html">Cloud Architecture</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/project/project-upgrade-parent.html">Upgrades and Patches</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/release-notes/cloud-tools.html">Release Notes</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">Cloud development</div>
              <ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/setup/first-time-setup.html">Local development</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/docker/docker-config.html">Launch Docker</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/docker/docker-quick-reference.html">Docker quick reference</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/env/environments.html">Configure Environments</a></li></ul>
            </div></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Setup</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/install-gde/bk-install-guide.html">Installation Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/extensions/">Magento Extensions Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/comp-mgr/bk-compman-upgrade-guide.html">Component Manager and System Upgrade Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/config-guide/bk-config-guide.html">Configuration Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/migration/bk-migration-guide.html">Migration Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/release-notes/bk-release-notes.html">Release Information</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/reference/cli/magento.html">Command-line Tools Reference</a></li></ul></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Development</span><div class="nav-popup"><div class="nav-section">
              <div class="nav-section-title">Backend</div>
              <ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/architecture/bk-architecture.html">Architecture</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/extension-dev-guide/bk-extension-dev-guide.html">PHP Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/ext-best-practices/bk-ext-best-practices.html">Extension Developer Best Practices</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/mrg/intro.html">Module Reference Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/coding-standards/bk-coding-standards.html">Coding Standards</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/contributor-guide/contributing.html">Contributor Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">Frontend</div>
              <ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/frontend-dev-guide/bk-frontend-dev-guide.html">Frontend Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/ui_comp_guide/bk-ui_comps.html">UI Components Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/javascript-dev-guide/bk-javascript-dev-guide.html">JavaScript Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/pattern-library/bk-pattern.html">Admin Design Pattern Library</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/design-styleguide/bk-styleguide.html">Admin Style Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">API</div>
              <ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/get-started/bk-get-started-api.html">Get Started with Magento Web APIs</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/rest/bk-rest.html">REST API Reference</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/soap/bk-soap.html">SOAP API Reference</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/marketplace/eqp/api.html">Marketplace EQP API Reference</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mbi/docs/getting-started.html">Business Intelligence Import API</a></li></ul>
            </div></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Testing</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/test/testing.html">Magento Testing Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/mtf/mtf_introduction.html">Functional Testing</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/test/integration/integration_test_execution.html">Integration Testing</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/test/js/jasmine.html">JavaScript Unit Testing</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/test/unit/unit_test_execution.html">PHP Unit Testing</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/get-started/web-api-functional-testing.html">Web API Functional Testing</a></li></ul></div></li><li class="nav-main-separator"></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Functional Areas</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/howdoi/checkout/checkout_overview.html">Checkout</a></li><li class="" role="menuitem"><a href="http://omsdocs.magento.com/en/">Order Management</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/payments-integrations/bk-payments-integrations.html">Payment Integrations</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/extension-dev-guide/staging.html">Staging</a></li></ul></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Tutorials</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/rest/tutorials/index.html">Rest Tutorials</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/howdoi/customize_product.html">Customize Product Creation Form</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/howdoi/checkout/checkout_overview.html">Customize Checkout</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/community/resources/support.html">Magento Support</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/videos/">Video Tutorials</a></li></ul></div></li></ul><!-- /.nav-main -->

    </div>

    <div class="search-btn">
      <button class="search-trigger search-icon" aria-label="Search"></button>
    </div>

    <form class="quick-search" action="/devdocs/2.1/search.html" method="get" novalidate="novalidate">
      <input type="search" name="q" placeholder="Search" />
      <button class="quick-search-close" aria-label="Close Search">&times;</button>
    </form>

  </div>

</nav><!-- #site-nav -->
<div class="nav-main-fader"></div>


	</header>

	<div class="global-wrapper">

		








		<div class="main-container">
			<a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
	<button class="toc-toggler">Table of Contents</button>
	<div class="sidebar-wrapper">

		

		<h4 class="guide-title">Magento Functional Testing Framework Guide</h4>
		<div class="collapsible-navigation">
		    <ul><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/introduction.html">Introduction</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/getting-started.html">Getting started</a></li><li class="" role="menuitem"><span>Best practices</span><ul><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/best-practices.html">Best practices</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/tips-tricks.html">Tips and tricks</a></li></ul></li><li class="" role="menuitem"><span>CLI Commands</span><ul><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/commands/mftf.html">mftf</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/commands/codeception.html">codecept</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/configuration.html">Configuration</a></li><li class="active" role="menuitem"><a href="/devdocs/2.1/mftf/docs/credentials.html">Credentials</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/data.html">Data</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/debugging.html">Debugging</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/extending.html">Extending</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/merge_points/introduction.html">Merge points for extensions</a><ul><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/merge_points/extend-action-groups.html">Extend action groups</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/merge_points/extend-data.html">Extend data</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/merge_points/extend-tests.html">Extend tests</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/merge_points/merge-action-groups.html">Merge action groups</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/merge_points/merge-data.html">Merge data</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/merge_points/merge-pages.html">Merge pages</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/merge_points/merge-sections.html">Merge sections</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/merge_points/merge-tests.html">Merge tests</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/merging.html">Merging</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/metadata.html">Metadata</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/page.html">Page</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/reporting.html">Reporting</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/section.html">Section</a><ul><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/section/parameterized-selectors.html">Parameterized selectors</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/section/locator-functions.html">Locator functions</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/suite.html">Suite</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/test.html">Test</a><ul><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/test/annotations.html">Annotations</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/test/actions.html">Actions</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/test/action-groups.html">Action groups</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/test/assertions.html">Assertions</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/troubleshooting.html">Troubleshooting</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/update.html">Update</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mftf/docs/versioning.html">Versioning</a></li><li class="" role="menuitem"><a href="https://github.com/magento/magento2-functional-testing-framework/blob/master/.github/CONTRIBUTING.md">Contribution guidelines</a></li><li class="" role="menuitem"><a href="https://github.com/magento/magento2-functional-testing-framework/blob/master/CHANGELOG.md">Changelog</a></li></ul>
		</div>

	</div>

</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<!-- page-header -->
<section class="page-intro">
	

	

	<h1 class="page-heading">Credentials</h1>
</section>

			<p>When you test functionality that involves external services such as UPS, FedEx, PayPal, or SignifyD,
use the MFTF credentials feature to hide sensitive <a href="/devdocs/2.1/mftf/docs/data.html">data</a> like integration tokens and API keys.</p>

<p>Currently the MFTF supports three types of credential storage:</p>

<ul>
  <li><strong>.credentials file</strong></li>
  <li><strong>HashiCorp Vault</strong></li>
  <li><strong>AWS Secrets Manager</strong></li>
</ul>

<h2 id="configure-file-storage">Configure File Storage</h2>

<p>The MFTF creates a sample file for credentials during <a href="/devdocs/2.1/mftf/docs/getting-started.html">initial setup</a>: <code class="highlighter-rouge">magento2/dev/tests/acceptance/.credentials.example</code>.
The file contains an example list of keys for fields that can require credentials.</p>

<h3 id="create-credentials">Create <code class="highlighter-rouge">.credentials</code></h3>

<p>To make the MFTF process the file with credentials, in the command line, navigate to <code class="highlighter-rouge">magento2/dev/tests/acceptance/</code> and rename <code class="highlighter-rouge">.credentials.example</code> to <code class="highlighter-rouge">.credentials</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cd </span>dev/tests/acceptance/
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cp</span> .credentials.example .credentials
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="add-credentials-to-gitignore">Add <code class="highlighter-rouge">.credentials</code> to <code class="highlighter-rouge">.gitignore</code></h3>

<p>Verify that the file is excluded from tracking by <code class="highlighter-rouge">.gitignore</code> (unless you need this behavior):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>git check-ignore .credentials
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The command outputs the path if the file is excluded:</p>

<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="go">.credentials
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="define-sensitive-data-in-the-credentials-file">Define sensitive data in the <code class="highlighter-rouge">.credentials</code> file</h3>

<p>Open the <code class="highlighter-rouge">.credentials</code> file and, for Magento core credentials, uncomment the fields you want to use and add your values:</p>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>...
<span class="c"># Credentials for the USPS service
</span><span class="n">magento</span>/<span class="n">carriers_usps_userid</span>=<span class="n">usps_test_user</span>
<span class="n">magento</span>/<span class="n">carriers_usps_password</span>=<span class="n">Lmgxvrq89uPwECeV</span>

<span class="c"># Credentials for the DHL service
#magento/carriers_dhl_id_us=dhl_test_user
#magento/carriers_dhl_password_us=Mlgxv3dsagVeG
</span>....
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Or add new key/value pairs for your own credentials. The keys use the following format:</p>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>&lt;<span class="n">vendor</span>&gt;/&lt;<span class="n">key_name</span>&gt;=&lt;<span class="n">key_value</span>&gt;
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="bs-callout bs-callout-info">
  <p>The <code class="highlighter-rouge">/</code> symbol is not supported in a <code class="highlighter-rouge">key_name</code> other than the one after your vendor or extension name.</p>
</div>

<p>Otherwise you are free to use any other <code class="highlighter-rouge">key_name</code> you like, as they are merely the keys to reference from your tests.</p>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># Credentials for the MyAwesome service
</span><span class="n">vendor</span>/<span class="n">my_awesome_service_token</span>=<span class="n">rRVSVnh3cbDsVG39oTMz4A</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="configure-vault-storage">Configure Vault Storage</h2>

<p>Hashicorp vault secures, stores, and tightly controls access to data in modern computing.
It provides advanced data protection for your testing credentials.</p>

<p>The MFTF works with both <code class="highlighter-rouge">vault enterprise</code> and <code class="highlighter-rouge">vault open source</code> that use <code class="highlighter-rouge">KV Version 2</code> secret engine.</p>

<h3 id="install-vault-cli">Install vault CLI</h3>

<p>Download and install vault CLI tool if you want to run or develop MFTF tests locally. <a href="https://www.hashicorp.com/products/vault/">Download Vault</a></p>

<h3 id="authenticate-to-vault-via-vault-cli">Authenticate to vault via vault CLI</h3>

<p>Authenticate to vault server via the vault CLI tool: <a href="https://www.vaultproject.io/docs/commands/login.html">Login Vault</a>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>vault login <span class="nt">-method</span> <span class="nt">-path</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>Do not</strong> use <code class="highlighter-rouge">-no-store</code> command option, as the MFTF will rely on the persisted token in the token helper (usually the local filesystem) for future API requests.</p>

<h3 id="store-secrets-in-vault">Store secrets in vault</h3>

<p>The MFTF uses the <code class="highlighter-rouge">KV Version 2</code> secret engine for secret storage.
More information for working with <code class="highlighter-rouge">KV Version 2</code> can be found in <a href="https://www.vaultproject.io/docs/secrets/kv/kv-v2.html">Vault KV2</a>.</p>

<h4 id="secrets-path-and-key-convention">Secrets path and key convention</h4>

<p>The path and key for secret data must follow the format:</p>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>&lt;<span class="n">SECRETS_BASE_PATH</span>&gt;/<span class="n">mftf</span>/&lt;<span class="n">VENDOR</span>&gt;/&lt;<span class="n">SECRET_KEY</span>&gt;
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># Secret path and key for carriers_usps_userid
</span><span class="n">secret</span>/<span class="n">mftf</span>/<span class="n">magento</span>/<span class="n">carriers_usps_userid</span>

<span class="c"># Secret path and key for carriers_usps_password
</span><span class="n">secret</span>/<span class="n">mftf</span>/<span class="n">magento</span>/<span class="n">carriers_usps_password</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="write-secrets-to-vault">Write secrets to vault</h4>

<p>You can use vault CLI or API to write secret data (credentials, etc) to vault. Here is a CLI example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>vault kv put secret/mftf/magento/carriers_usps_userid <span class="nv">carriers_usps_userid</span><span class="o">=</span>usps_test_user
vault kv put secret/mftf/magento/carriers_usps_password <span class="nv">carriers_usps_password</span><span class="o">=</span>Lmgxvrq89uPwECeV
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="setup-mftf-to-use-vault">Setup MFTF to use vault</h3>

<p>Add vault configuration environment variables <a href="/devdocs/2.1/mftf/docs/configuration.html#credential_vault_address"><code class="highlighter-rouge">CREDENTIAL_VAULT_ADDRESS</code></a> and <a href="/devdocs/2.1/mftf/docs/configuration.html#credential_vault_secret_base_path"><code class="highlighter-rouge">CREDENTIAL_VAULT_SECRET_BASE_PATH</code></a>
from <code class="highlighter-rouge">etc/config/.env.example</code> in <code class="highlighter-rouge">.env</code>.
Set values according to your vault server configuration.</p>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c"># Default vault dev server
</span><span class="n">CREDENTIAL_VAULT_ADDRESS</span>=<span class="n">http</span>://<span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>:<span class="m">8200</span>
<span class="n">CREDENTIAL_VAULT_SECRET_BASE_PATH</span>=<span class="n">secret</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="configure-aws-secrets-manager">Configure AWS Secrets Manager</h2>

<p>AWS Secrets Manager offers secret management that supports:</p>
<ul>
  <li>Secret rotation with built-in integration for Amazon RDS, Amazon Redshift, and Amazon DocumentDB</li>
  <li>Fine-grained policies and permissions</li>
  <li>Audit secret rotation centrally for resources in the AWS Cloud, third-party services, and on-premises</li>
</ul>

<h3 id="prerequisites">Prerequisites</h3>

<h4 id="use-aws-secrets-manager-from-your-own-aws-account">Use AWS Secrets Manager from your own AWS account</h4>

<ul>
  <li>An AWS account with Secrets Manager service</li>
  <li>An IAM user with AWS Secrets Manager access permission</li>
</ul>

<h4 id="use-aws-secrets-manager-in-cicd">Use AWS Secrets Manager in CI/CD</h4>

<ul>
  <li>AWS account ID where the AWS Secrets Manager service is hosted</li>
  <li>Authorized CI/CD EC2 instances with AWS Secrets Manager service access IAM role attached</li>
</ul>

<h3 id="store-secrets-in-aws-secrets-manager">Store secrets in AWS Secrets Manager</h3>

<h4 id="secrets-format">Secrets format</h4>

<p><code class="highlighter-rouge">Secret Name</code> and <code class="highlighter-rouge">Secret Value</code> are two key pieces of information for creating a secret.</p>

<p><code class="highlighter-rouge">Secret Value</code> can be either plaintext or key/value pairs in JSON format.</p>

<p><code class="highlighter-rouge">Secret Name</code> must use the following format:</p>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">mftf</span>/&lt;<span class="n">VENDOR</span>&gt;/&lt;<span class="n">YOUR</span>/<span class="n">SECRET</span>/<span class="n">KEY</span>&gt;
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="highlighter-rouge">Secret Value</code> can be stored in two different formats: plaintext or key/value pairs.</p>

<p>For plaintext format, <code class="highlighter-rouge">Secret Value</code> can be any string you want to secure.</p>

<p>For key/value pairs format, <code class="highlighter-rouge">Secret Value</code> is a key/value pair with <code class="highlighter-rouge">key</code> the same as <code class="highlighter-rouge">Secret Name</code> without <code class="highlighter-rouge">mftf/&lt;VENDOR&gt;/</code> prefix,  which is <code class="highlighter-rouge">&lt;YOUR/SECRET/KEY&gt;</code>, and value can be any string you want to secure.</p>

<h5 id="create-secrets-using-aws-cli">Create Secrets using AWS CLI</h5>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>aws secretsmanager create-secret <span class="nt">--name</span> <span class="s2">"mftf/magento/shipping/carriers_usps_userid"</span> <span class="nt">--description</span> <span class="s2">"Carriers USPS user id"</span> <span class="nt">--secret-string</span> <span class="s2">"1234567"</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h5 id="create-secrets-using-aws-console">Create Secrets using AWS Console</h5>

<ul>
  <li>Sign in to the AWS Secrets Manager console</li>
  <li>Choose Store a new secret</li>
  <li>In the Select secret type section, specify “Other type of secret”</li>
  <li>For <code class="highlighter-rouge">Secret Name</code>, <code class="highlighter-rouge">Secret Key</code> and <code class="highlighter-rouge">Secret Value</code> field, for example, to save the same secret in key/value JSON format, you should use</li>
</ul>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c"># Secret Name
</span><span class="n">mftf</span>/<span class="n">magento</span>/<span class="n">shipping</span>/<span class="n">carriers_usps_userid</span>

<span class="c"># Secret Key
</span><span class="n">shipping</span>/<span class="n">carriers_usps_userid</span>

<span class="c"># Secret Value
</span><span class="m">1234567</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="setup-mftf-to-use-aws-secrets-manager">Setup MFTF to use AWS Secrets Manager</h3>

<p>To use AWS Secrets Manager, the AWS region to connect to is required. You can set it through environment variable <a href="/devdocs/2.1/mftf/docs/configuration.html#credential_aws_secrets_manager_region"><code class="highlighter-rouge">CREDENTIAL_AWS_SECRETS_MANAGER_REGION</code></a> in <code class="highlighter-rouge">.env</code>.</p>

<p>MFTF uses the recommended <a href="https://docs.aws.amazon.com/sdk-for-php/v3/developer-guide/guide_credentials.html">Default Credential Provider Chain</a> to establish connection to AWS Secrets Manager service. 
You can setup credentials according to <a href="https://docs.aws.amazon.com/sdk-for-php/v3/developer-guide/guide_credentials.html">Default Credential Provider Chain</a> and there is no MFTF specific setup required. 
Optionally, however, you can explicitly set AWS profile through environment variable <a href="/devdocs/2.1/mftf/docs/configuration.html#credential_aws_secrets_manager_profile"><code class="highlighter-rouge">CREDENTIAL_AWS_SECRETS_MANAGER_PROFILE</code></a> in <code class="highlighter-rouge">.env</code>.</p>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c"># Sample AWS Secrets Manager configuration
</span><span class="n">CREDENTIAL_AWS_SECRETS_MANAGER_REGION</span>=<span class="n">us</span>-<span class="n">east</span>-<span class="m">1</span>
<span class="n">CREDENTIAL_AWS_SECRETS_MANAGER_PROFILE</span>=<span class="n">default</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="optionally-set-credential_aws_account_id-environment-variable">Optionally set CREDENTIAL_AWS_ACCOUNT_ID environment variable</h3>

<p>In case AWS credentials cannot resolve to a valid AWS account, full AWS KMS (<a href="https://aws.amazon.com/kms/">Key Management Service</a>) key ARN (<a href="https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html">Amazon Resource Name</a>) is required.
You will also need to set <code class="highlighter-rouge">CREDENTIAL_AWS_ACCOUNT_ID</code> environment variable so that MFTF can construct the full ARN. This is mostly used for CI/CD.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">CREDENTIAL_AWS_ACCOUNT_ID</span><span class="o">=</span>&lt;Your_12_Digits_AWS_Account_ID&gt;
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="configure-multiple-credential-storage">Configure multiple credential storage</h2>

<p>It is possible and sometimes useful to setup and use multiple credential storage at the same time.
In this case, the MFTF tests are able to read secret data at runtime from all storage options, in this case MFTF use the following precedence:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>.credentials File &gt; HashiCorp Vault &gt; AWS Secrets Manager
</pre></td></tr></tbody></table></code></pre></div></div>
<!--  -->

<h2 id="use-credentials-in-a-test">Use credentials in a test</h2>

<p>Credentials can be used in actions: <a href="/devdocs/2.1/mftf/docs/test/actions.html#fillfield"><code class="highlighter-rouge">fillField</code></a>, <a href="/devdocs/2.1/mftf/docs/test/actions.html#magentocli"><code class="highlighter-rouge">magentoCLI</code></a>, and <a href="/devdocs/2.1/mftf/docs/test/actions.html#createdata"><code class="highlighter-rouge">createData</code></a>.</p>

<p>Define the value as a reference to the corresponding key in the credentials file or vault such as <code class="highlighter-rouge">{{_CREDS.my_data_key}}</code>:</p>

<ul>
  <li><code class="highlighter-rouge">_CREDS</code> is an environment constant pointing to the <code class="highlighter-rouge">.credentials</code> file</li>
  <li><code class="highlighter-rouge">my_data_key</code> is a key in the the <code class="highlighter-rouge">.credentials</code> file or vault that contains the value to be used in a test step
    <ul>
      <li>for File Storage, ensure your key contains the vendor prefix, which is <code class="highlighter-rouge">vendor/my_data_key</code></li>
    </ul>
  </li>
</ul>

<p>For example, to reference secret data in the <a href="/devdocs/2.1/mftf/docs/test/actions.html#fillfield"><code class="highlighter-rouge">fillField</code></a> action, use the <code class="highlighter-rouge">userInput</code> attribute using a typical File Storage:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;fillField</span> <span class="na">stepKey=</span><span class="s">"FillApiToken"</span> <span class="na">selector=</span><span class="s">".api-token"</span> <span class="na">userInput=</span><span class="s">"{{_CREDS.vendor/my_data_key}}"</span> <span class="nt">/&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<!--  -->

<h2 id="implementation-details">Implementation details</h2>

<p>The generated tests do not contain credentials values.
The MFTF dynamically retrieves, encrypts, and decrypts the sensitive data during test execution.
Decrypted credentials do not appear in the console, error logs, or <a href="/devdocs/2.1/mftf/docs/reporting.html">test reports</a>.
The decrypted values are only available in the <code class="highlighter-rouge">.credentials</code> file or within vault.</p>

<div class="bs-callout bs-callout-info">
The MFTF tests delivered with Magento application do not use credentials and do not cover external services, because of sensitivity of the data.
</div>

<!-- Link definitions -->


			
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

  
  <div class="page-updated">
    <img src="/devdocs/2.1/i/icons/time.svg" alt="Updated" />
    <time id="last-modified-at" itemprop="dateModified" datetime="2020-01-27">
      Jan 27th, 2020
    </time>
  </div>
  

  


  

    

    

  

</div>


	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->


	</div>
	<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      

<ul class="nav footer-links" role="menu">

  <li class="" role="menuitem"><a href="https://github.com/magento/devdocs/blob/master/.github/CONTRIBUTING.md">Become a Contributor</a></li>

  <li class="" role="menuitem"><a href="https://glossary.magento.com/">Glossary</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/terms/privacy/">Privacy Policy</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/terms/">Terms of Service</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/licensing/">License/Trademark FAQ</a></li>

  <li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/release-notes/bk-release-notes.html">Release Notes</a></li>

  <li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/release-notes/packages-open-source.html">Third-Party Licenses</a></li>

</ul>

    </div>

		<div class="copyright-date">&copy; 2023 Magento. All rights reserved.</div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/devdocs/2.1/assets/js/app.min.js"></script>





<script type="text/javascript" src="/devdocs/2.1/common/js/last-modified-at.js"></script>
<script type="text/javascript" src="/devdocs/2.1/common/js/glossary-link-enhancer.js"></script>


</body>
</html>

