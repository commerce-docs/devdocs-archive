<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>How content migration works | Archived Magento 2.1 Developer Documentation</title>
	<meta name="description" content="Archived Magento 2.1.18 Developer Documentation.">

	<link rel="stylesheet" href="/devdocs/2.1/assets/css/app.css" />
	<link rel="stylesheet" href="/devdocs/2.1/assets/css/print.css" media="print"/>

	<link rel="stylesheet" href="/devdocs/2.1/common/css/devdocs.css" />
<link rel="alternate" type="application/rss+xml" title="Magento DevDocs RSS" href="/feed.xml" />



	<script>
  var baseUrl = "/devdocs/2.1";
  var algolia = {
    id : "",
    index:  "",
    key:  "",
    facetFilters: [["guide_version: 2.1", "versionless: true"]]
  };
</script>




	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
	<link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
	<link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>
<body class="layout-default">

	<header class="site-header">

		<nav class="site-nav">

  <div class="menu-btn">
    <button id="menu-btn" class="menu-trigger menu-icon" aria-haspopup="true" aria-controls="nav-main" aria-label="Menu"></button>
  </div>

  <div class="nav-container">

    <a class="logo" href="/devdocs/2.1/">
      <img src="/devdocs/2.1/assets/i/m-logo.svg" alt=""><img src="/devdocs/2.1/assets/i/magento-logo.svg" alt="Magento" class="magento-logo" />
      <span class="site-logo">DevDocs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      



      <!-- Main Navigation --><ul class="nav-main" role="menubar"><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Cloud</span><div class="nav-popup"><div class="nav-section">
              <div class="nav-section-title">Cloud basics</div>
              <ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/bk-cloud.html">Cloud Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/architecture/cloud-architecture.html">Cloud Architecture</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/project/project-upgrade-parent.html">Upgrades and Patches</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/release-notes/cloud-tools.html">Release Notes</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">Cloud development</div>
              <ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/setup/first-time-setup.html">Local development</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/docker/docker-config.html">Launch Docker</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/docker/docker-quick-reference.html">Docker quick reference</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/cloud/env/environments.html">Configure Environments</a></li></ul>
            </div></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Setup</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/install-gde/bk-install-guide.html">Installation Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/extensions/">Magento Extensions Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/comp-mgr/bk-compman-upgrade-guide.html">Component Manager and System Upgrade Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/config-guide/bk-config-guide.html">Configuration Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/migration/bk-migration-guide.html">Migration Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/release-notes/bk-release-notes.html">Release Information</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/reference/cli/magento.html">Command-line Tools Reference</a></li></ul></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Development</span><div class="nav-popup"><div class="nav-section">
              <div class="nav-section-title">Backend</div>
              <ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/architecture/bk-architecture.html">Architecture</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/extension-dev-guide/bk-extension-dev-guide.html">PHP Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/ext-best-practices/bk-ext-best-practices.html">Extension Developer Best Practices</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/mrg/intro.html">Module Reference Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/coding-standards/bk-coding-standards.html">Coding Standards</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/contributor-guide/contributing.html">Contributor Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">Frontend</div>
              <ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/frontend-dev-guide/bk-frontend-dev-guide.html">Frontend Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/ui_comp_guide/bk-ui_comps.html">UI Components Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/javascript-dev-guide/bk-javascript-dev-guide.html">JavaScript Developer Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/pattern-library/bk-pattern.html">Admin Design Pattern Library</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/design-styleguide/bk-styleguide.html">Admin Style Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="nav-section-title">API</div>
              <ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/get-started/bk-get-started-api.html">Get Started with Magento Web APIs</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/rest/bk-rest.html">REST API Reference</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/soap/bk-soap.html">SOAP API Reference</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/marketplace/eqp/api.html">Marketplace EQP API Reference</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/mbi/docs/getting-started.html">Business Intelligence Import API</a></li></ul>
            </div></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Testing</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/test/testing.html">Magento Testing Guide</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/mtf/mtf_introduction.html">Functional Testing</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/test/integration/integration_test_execution.html">Integration Testing</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/test/js/jasmine.html">JavaScript Unit Testing</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/test/unit/unit_test_execution.html">PHP Unit Testing</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/get-started/web-api-functional-testing.html">Web API Functional Testing</a></li></ul></div></li><li class="nav-main-separator"></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Functional Areas</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/howdoi/checkout/checkout_overview.html">Checkout</a></li><li class="" role="menuitem"><a href="http://omsdocs.magento.com/en/">Order Management</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/payments-integrations/bk-payments-integrations.html">Payment Integrations</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/extension-dev-guide/staging.html">Staging</a></li></ul></div></li><li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Tutorials</span><div class="nav-popup"><ul><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/rest/tutorials/index.html">Rest Tutorials</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/howdoi/customize_product.html">Customize Product Creation Form</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/howdoi/checkout/checkout_overview.html">Customize Checkout</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/community/resources/support.html">Magento Support</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/videos/">Video Tutorials</a></li></ul></div></li></ul><!-- /.nav-main -->

    </div>

    <div class="search-btn">
      <button class="search-trigger search-icon" aria-label="Search"></button>
    </div>

    <form class="quick-search" action="/devdocs/2.1/search.html" method="get" novalidate="novalidate">
      <input type="search" name="q" placeholder="Search" />
      <button class="quick-search-close" aria-label="Close Search">&times;</button>
    </form>

  </div>

</nav><!-- #site-nav -->
<div class="nav-main-fader"></div>


	</header>

	<div class="global-wrapper">

		








		<div class="main-container">
			<a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
	<button class="toc-toggler">Table of Contents</button>
	<div class="sidebar-wrapper">

		

		<h4 class="guide-title">Page Builder</h4>
		<div class="collapsible-navigation">
		    <ul><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/">What is Page Builder?</a></li><li class="" role="menuitem"><span>Getting started</span><ul><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/getting-started/install-pagebuilder.html">Install Page Builder</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/getting-started/view-pagebuilder.html">View Page Builder</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/getting-started/install-pagebuilder-examples.html">Install Page Builder Examples</a></li></ul></li><li class="" role="menuitem"><span>Extend a content type</span><ul><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/extend-existing-content-type/overview.html">Overview</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/extend-existing-content-type/step-1-create-extension-module.html">Step 1. Create extension module</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/extend-existing-content-type/step-2-extend-appearances.html">Step 2. Extend appearances</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/extend-existing-content-type/step-3-extend-forms.html">Step 3. Extend forms</a></li></ul></li><li class="" role="menuitem"><span>Create a content type</span><ul><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/create-custom-content-type/overview.html">Overview</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/create-custom-content-type/step-1-add-configuration.html">Step 1. Add configuration</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/create-custom-content-type/step-2-add-templates.html">Step 2. Add templates</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/create-custom-content-type/step-3-add-components.html">Step 3. Add components</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/create-custom-content-type/step-4-add-form.html">Step 4. Add form</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/create-custom-content-type/step-5-add-styles.html">Step 5. Add styles</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/create-custom-content-type/step-6-add-icon.html">Step 6. Add an icon</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/create-custom-content-type/summary.html">Summary</a></li></ul></li><li class="" role="menuitem"><span>How-Tos</span><ul><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-customize-panel.html">How to customize the panel</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-add-image-uploader.html">How to add an image uploader</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-add-storefront-widget.html">How to add a storefront widget</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-add-text-editor.html">How to add a text editor</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-add-custom-toolbar.html">How to add a custom toolbar</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-add-icons-images.html">How to add icons and images</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-change-breakpoints.html">How to change breakpoints</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-add-additional-configurations.html">How to add additional configurations</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-add-block-chooser.html">How to add a block chooser</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-use-full-width-layouts.html">How to use full-width layouts</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-customize-selectors.html">How to customize selectors</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-apply-product-conditions.html">How to apply product conditions</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-use-server-side-previews.html">How to use server-side previews</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-use-pagebuilder-for-product-attributes.html">How to use Page Builder for product attributes</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/how-to/how-to-deactivate-pagebuilder.html">How to deactivate Page Builder</a></li></ul></li><li class="" role="menuitem"><span>BlueFoot content migration</span><ul><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder-migration/docs/">Overview of content migration</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder-migration/docs/install-migration-module.html">Install the migration module</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder-migration/docs/run-migration-module.html">Run the migration module</a></li><li class="active" role="menuitem"><a href="/devdocs/2.1/page-builder-migration/docs/how-content-migration-works.html">How content migration works</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder-migration/docs/migrate-content-custom-blocks.html">Migrate content from custom blocks</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder-migration/docs/migrate-other-bluefoot-content.html">Migrate other BlueFoot content</a></li></ul></li><li class="" role="menuitem"><span>Reference</span><ul><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/reference/architecture.html">Architecture</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/reference/configurations.html">Configurations</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/reference/data-store.html">Datastore</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/reference/events.html">Events</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/reference/knockout-bindings.html">Knockout bindings</a></li></ul></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/release-notes.html">Release notes</a></li><li class="" role="menuitem"><a href="/devdocs/2.1/page-builder/docs/comp-status2.html">Component status</a></li><li class="" role="menuitem"><a href="https://github.com/magento/magento2-page-builder/blob/1.0-develop/CONTRIBUTING.md">Contribution guide</a></li></ul>
		</div>

	</div>

</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<!-- page-header -->
<section class="page-intro">
	

	

	<h1 class="page-heading">How content migration works</h1>
</section>

			<p>Each content type has a corresponding renderer to convert the old BlueFoot JSON structure into the new PageBuilder format. The Page Builder format uses HTML to store all data associated with the content type within the DOM tree through attributes, styles, and child nodes. You can find out more information in our <a href="https://devdocs.magento.com/page-builder/docs/reference/architecture.html">Page Builder Architecture</a> article.</p>

<p>In contrast to BlueFoot, the HTML structure we generate contains all the information needed to render the content type, this HTML string is committed directly into the database in place of the BlueFoot string.</p>

<p>Migrating will result in any field containing <code class="highlighter-rouge">&lt;!--GENE_BLUEFOOT="…"--&gt;</code> to now containing valid HTML with embedded metadata storing the configuration of the content type.</p>

<h2 id="data-converters">Data Converters</h2>

<p>We have two data converters provided out of the box which enable migration of data from different sources.</p>

<p>These data converters are located within <code class="highlighter-rouge">app/code/Magento/PageBuilderDataMigration/Setup/DataConverter</code>.</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">BlueFootToPageBuilder</code></td>
      <td>Consumes BlueFoot generated content structures formed of JSON and uses renderer’s to convert every content type to Page Builder HTML. In the instance the data converter encounters an error it will store the original JSON as un-migrated content.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">MixedToPageBuilder</code></td>
      <td>If the above data converter fails on a particular piece of content due to an error or missing renderer for the content type it will have it’s data preserved as un-migrated content. In this instance you can use the mixed data converter to run the un-migrated content blocks through the renderer’s again.</td>
    </tr>
  </tbody>
</table>

<p>You can find more information on how to use the <code class="highlighter-rouge">MixedToPageBuilder</code> converter within our <a href="/devdocs/2.1/page-builder-migration/docs/migrate-content-custom-blocks.html">Migrate content from custom blocks</a> guide. We do not use this data converter out of the box so it will not be ran unless the steps in the attached guide are followed.</p>

<h3 id="un-migrated-content">Un-migrated content</h3>

<p>We have a custom error handler along with logic to ensure that any issue content which fails during migration is preserved. If this logic of error handler are triggered you can expect to see errors within <code class="highlighter-rouge">var/log/system.log</code> along with the content being stored like the following in your migrated output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;div</span> <span class="na">data-element=</span><span class="s">"main"</span> <span class="na">data-content-type=</span><span class="s">"row"</span> <span class="na">data-appearance=</span><span class="s">"contained"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">data-element=</span><span class="s">"main"</span> <span class="na">data-content-type=</span><span class="s">"html"</span> <span class="na">data-appearance=</span><span class="s">"default"</span><span class="nt">&gt;</span>
        <span class="ni">&amp;lt;</span>!--UNMIGRATED_CONTENT="{"type":"custom","children":[]}"--<span class="ni">&amp;gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The content is placed within a HTML content type and the original JSON is stored within a similar HTML comment as the BlueFoot data. This ensures preservation of the content to be migrated at a later point. HTML code has it’s contents encoded, those the greater than and less than symbols being encoded.</p>

<p>The usage of the HTML code content type allows for other aspects of the page to be edited within Page Builder whilst allowing this special content to be stored until the migration tools are available.</p>

<h2 id="renderer">Renderer</h2>

<p>Every content type which is supported by the migration suite will have a renderer defined to translate the BlueFoot JSON data into valid Page Builder HTML. These renderers do not share the code used by the Page Builder tool itself due to our master format rendering being implemented in JavaScript.</p>

<p>Each renderer implements a straightforward interface (<code class="highlighter-rouge">Magento\PageBuilder\Setup\DataConverter\RendererInterface</code>) which defines a single <code class="highlighter-rouge">render</code> method which is responsible for consuming the form &amp; EAV data and returning the valid Page Builder HTML.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="kd">interface</span> <span class="nc">RendererInterface</span>
<span class="p">{</span>
    <span class="cd">/**
     * Render HTML for content type
     *
     * @param array $itemData
     * @param array $additionalData
     * @return string
     * @throws \InvalidArgumentException
     * @throws NoSuchEntityException
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">render</span><span class="p">(</span><span class="kt">array</span> <span class="nv">$itemData</span><span class="p">,</span> <span class="kt">array</span> <span class="nv">$additionalData</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">:</span> <span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="parameters">Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">$itemData</code></td>
      <td>All associated item data for the content type, this will contain the form data along with the associated BlueFoot entity ID.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">$additionalData</code></td>
      <td>In some instances, there will be additional information associated with the content type. Most commonly used when a content type has children.</td>
    </tr>
  </tbody>
</table>

<h3 style="table-layout:auto" id="location">Location</h3>
<p>All the core content type renders are located in <code class="highlighter-rouge">Setup/DataConverter/Renderer</code>:</p>

<p><img src="/devdocs/2.1/page-builder-migration/docs/images/migration-core-renderers.png" alt="Core renderer location" width="411px" height="auto" /></p>

<h3 id="example-renderer">Example Renderer</h3>
<p>To learn more about renderers, let’s look at the Heading renderer code, then discuss the key parts.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
</pre></td><td class="rouge-code"><pre><span class="cd">/**
 * Copyright © Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */</span>
<span class="k">declare</span><span class="p">(</span><span class="n">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>

<span class="kn">namespace</span> <span class="nn">Magento\PageBuilderDataMigration\Setup\DataConverter\Renderer</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Magento\PageBuilderDataMigration\Setup\DataConverter\RendererInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Magento\PageBuilderDataMigration\Setup\DataConverter\EavAttributeLoaderInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Magento\PageBuilderDataMigration\Setup\DataConverter\StyleExtractorInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Magento\PageBuilderDataMigration\Setup\DataConverter\ElementRendererInterface</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">Heading</span> <span class="kd">implements</span> <span class="nc">RendererInterface</span>
<span class="p">{</span>
    <span class="cd">/**
     * @var StyleExtractorInterface
     */</span>
    <span class="k">private</span> <span class="nv">$styleExtractor</span><span class="p">;</span>

    <span class="cd">/**
     * @var EavAttributeLoaderInterface
     */</span>
    <span class="k">private</span> <span class="nv">$eavAttributeLoader</span><span class="p">;</span>

    <span class="cd">/**
     * @var ElementRendererInterface
     */</span>
    <span class="k">private</span> <span class="nv">$elementRenderer</span><span class="p">;</span>

    <span class="cd">/**
     * @param StyleExtractorInterface $styleExtractor
     * @param EavAttributeLoaderInterface $eavAttributeLoader
     * @param ElementRendererInterface $elementRenderer
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span>
        <span class="kt">StyleExtractorInterface</span> <span class="nv">$styleExtractor</span><span class="p">,</span>
        <span class="kt">EavAttributeLoaderInterface</span> <span class="nv">$eavAttributeLoader</span><span class="p">,</span>
        <span class="kt">ElementRendererInterface</span> <span class="nv">$elementRenderer</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">styleExtractor</span> <span class="o">=</span> <span class="nv">$styleExtractor</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">eavAttributeLoader</span> <span class="o">=</span> <span class="nv">$eavAttributeLoader</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">elementRenderer</span> <span class="o">=</span> <span class="nv">$elementRenderer</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @inheritdoc
     *
     * @throws \Magento\Framework\Exception\NoSuchEntityException
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">render</span><span class="p">(</span><span class="kt">array</span> <span class="nv">$itemData</span><span class="p">,</span> <span class="kt">array</span> <span class="nv">$additionalData</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">:</span> <span class="kt">string</span>
    <span class="p">{</span>
        <span class="nv">$eavData</span> <span class="o">=</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$itemData</span><span class="p">[</span><span class="s1">'entityId'</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">eavAttributeLoader</span><span class="o">-&gt;</span><span class="nf">load</span><span class="p">(</span><span class="nv">$itemData</span><span class="p">[</span><span class="s1">'entityId'</span><span class="p">])</span> <span class="o">:</span> <span class="p">[];</span>

        <span class="nv">$rootElementAttributes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">'data-element'</span> <span class="o">=&gt;</span> <span class="s1">'main'</span><span class="p">,</span>
            <span class="s1">'data-content-type'</span> <span class="o">=&gt;</span> <span class="s1">'heading'</span><span class="p">,</span>
            <span class="s1">'data-appearance'</span> <span class="o">=&gt;</span> <span class="s1">'default'</span><span class="p">,</span>
            <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="nv">$eavData</span><span class="p">[</span><span class="s1">'css_classes'</span><span class="p">]</span> <span class="o">??</span> <span class="s1">''</span>
        <span class="p">];</span>

        <span class="nv">$formData</span> <span class="o">=</span> <span class="nv">$itemData</span><span class="p">[</span><span class="s1">'formData'</span><span class="p">]</span> <span class="o">??</span> <span class="p">[];</span>
        <span class="nv">$rootElementAttributes</span><span class="p">[</span><span class="s1">'style'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">styleExtractor</span><span class="o">-&gt;</span><span class="nf">extractStyle</span><span class="p">(</span>
            <span class="nv">$formData</span><span class="p">,</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">getAdvancedDefaults</span><span class="p">()</span>
        <span class="p">);</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">elementRenderer</span><span class="o">-&gt;</span><span class="nf">render</span><span class="p">(</span>
            <span class="nv">$eavData</span><span class="p">[</span><span class="s1">'heading_type'</span><span class="p">]</span> <span class="o">??</span> <span class="s1">'h2'</span><span class="p">,</span>
            <span class="nv">$rootElementAttributes</span><span class="p">,</span>
            <span class="nv">$eavData</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span> <span class="o">??</span> <span class="s1">''</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Define the defaults for the advanced section
     *
     * @return array
     */</span>
    <span class="k">private</span> <span class="k">function</span> <span class="n">getAdvancedDefaults</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="s1">'border-style'</span> <span class="o">=&gt;</span> <span class="s1">'none'</span><span class="p">,</span>
            <span class="s1">'border-width'</span> <span class="o">=&gt;</span> <span class="s1">'1px'</span><span class="p">,</span>
            <span class="s1">'border-radius'</span> <span class="o">=&gt;</span> <span class="s1">'0px'</span><span class="p">,</span>
        <span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="parts-of-a-renderer">Parts of a renderer</h3>

<p>The significant parts of a content type renderer are as follows:</p>

<h4 id="constructor-dependency-injection">Constructor dependency injection</h4>

<p>First, we use <a href="https://devdocs.magento.com/guides/v2.3/extension-dev-guide/depend-inj.html">dependency injection</a> to include our dependencies. These are all aspects of Data Migration that aid in retrieving and formatting data along with rendering DOM elements. We go into these in more detail below.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span>
        <span class="kt">StyleExtractorInterface</span> <span class="nv">$styleExtractor</span><span class="p">,</span>
        <span class="kt">EavAttributeLoaderInterface</span> <span class="nv">$eavAttributeLoader</span><span class="p">,</span>
        <span class="kt">ElementRendererInterface</span> <span class="nv">$elementRenderer</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">styleExtractor</span> <span class="o">=</span> <span class="nv">$styleExtractor</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">eavAttributeLoader</span> <span class="o">=</span> <span class="nv">$eavAttributeLoader</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">elementRenderer</span> <span class="o">=</span> <span class="nv">$elementRenderer</span><span class="p">;</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="render-function">Render function</h4>

<p>We then have the initial part of our render function, as the Heading content type in BlueFoot stored some data in its EAV tables we need to retrieve that data using the <code class="highlighter-rouge">EavAttributeLoaderInterface</code>. A renderer has to support rendering an empty content type as supported by BlueFoot, due to this reason we set the <code class="highlighter-rouge">$eavData</code> to an empty array if the content type is lacking an entity ID.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>    <span class="k">public</span> <span class="k">function</span> <span class="n">render</span><span class="p">(</span><span class="kt">array</span> <span class="nv">$itemData</span><span class="p">,</span> <span class="kt">array</span> <span class="nv">$additionalData</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">:</span> <span class="kt">string</span>
    <span class="p">{</span>
        <span class="nv">$eavData</span> <span class="o">=</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$itemData</span><span class="p">[</span><span class="s1">'entityId'</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">eavAttributeLoader</span><span class="o">-&gt;</span><span class="nf">load</span><span class="p">(</span><span class="nv">$itemData</span><span class="p">[</span><span class="s1">'entityId'</span><span class="p">])</span> <span class="o">:</span> <span class="p">[];</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="root-element-attributes">Root element attributes</h4>

<p>Next, we declare the root element attributes which should be rendered on our root element; this allows us to make modifications based on conditions further down if required. Note how we’re ensuring if there is no value set for things like <code class="highlighter-rouge">css_classes</code> and <code class="highlighter-rouge">formData</code> we default these to empty arrays to allow the renderer to produce an output regardless.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>        <span class="nv">$rootElementAttributes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">'data-element'</span> <span class="o">=&gt;</span> <span class="s1">'main'</span><span class="p">,</span>
            <span class="s1">'data-content-type'</span> <span class="o">=&gt;</span> <span class="s1">'heading'</span><span class="p">,</span>
            <span class="s1">'data-appearance'</span> <span class="o">=&gt;</span> <span class="s1">'default'</span><span class="p">,</span>
            <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="nv">$eavData</span><span class="p">[</span><span class="s1">'css_classes'</span><span class="p">]</span> <span class="o">??</span> <span class="s1">''</span>
        <span class="p">];</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="form-data">Form data</h4>

<p>Within BlueFoot, block data is stored in two different places: database EAV tables and JSON. Most of the data is stored in the EAV tables. However, the “advanced” section within BlueFoot is not persisted to the database. It is held in the JSON format. We refer to this as <code class="highlighter-rouge">formData</code> and ensure this value is present as an empty array if no data is provided as part of the <code class="highlighter-rouge">$itemdata</code>:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>        <span class="nv">$formData</span> <span class="o">=</span> <span class="nv">$itemData</span><span class="p">[</span><span class="s1">'formData'</span><span class="p">]</span> <span class="o">??</span> <span class="p">[];</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="style-extractor">Style extractor</h4>

<p>We retrieved the form data above for usage in the style extractor (<code class="highlighter-rouge">StyleExtractorInterface</code>), this serves as a helper class to retrieve and build the style declaration for the current content type based on the form data and any defaults, notably throughout the default renderers we use the function name <code class="highlighter-rouge">getAdvancedDefaults</code>.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>        <span class="nv">$rootElementAttributes</span><span class="p">[</span><span class="s1">'style'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">styleExtractor</span><span class="o">-&gt;</span><span class="nf">extractStyle</span><span class="p">(</span>
            <span class="nv">$formData</span><span class="p">,</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">getAdvancedDefaults</span><span class="p">()</span>
        <span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="element-renderer">Element renderer</h4>

<p>Along with the EAV &amp; style classes we provide an element renderer class (<code class="highlighter-rouge">ElementRendererInterface</code>) to help when generating DOM elements from the BlueFoot JSON. In our instance, our element should have the tag name associated with the heading type, or by default h2, along with our previously defined root element attributes. Finally, we use the <code class="highlighter-rouge">title</code> from the EAV data as the contents of the element.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">elementRenderer</span><span class="o">-&gt;</span><span class="nf">render</span><span class="p">(</span>
            <span class="nv">$eavData</span><span class="p">[</span><span class="s1">'heading_type'</span><span class="p">]</span> <span class="o">??</span> <span class="s1">'h2'</span><span class="p">,</span>
            <span class="nv">$rootElementAttributes</span><span class="p">,</span>
            <span class="nv">$eavData</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span> <span class="o">??</span> <span class="s1">''</span>
        <span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="default-form-values">Default form values</h4>

<p>We declare the advanced defaults for this content type. Each Page Builder content type can define default values within its form declaration. These values are automatically applied to the content types master format on creation. BlueFoot did not implement the same system, which means you must declare the defaults for inclusion here manually.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>    <span class="k">private</span> <span class="k">function</span> <span class="n">getAdvancedDefaults</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="s1">'border-style'</span> <span class="o">=&gt;</span> <span class="s1">'none'</span><span class="p">,</span>
            <span class="s1">'border-width'</span> <span class="o">=&gt;</span> <span class="s1">'1px'</span><span class="p">,</span>
            <span class="s1">'border-radius'</span> <span class="o">=&gt;</span> <span class="s1">'0px'</span><span class="p">,</span>
        <span class="p">];</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>In this instance, the defaults are very simple because there’s only a single DOM element for the entire content type. However, in more complex content types, we break out the default values into separate functions within the <code class="highlighter-rouge">getAdvancedDefaults()</code> function.</p>

<h3 id="eavattributeloaderinterface"><code class="highlighter-rouge">EavAttributeLoaderInterface</code></h3>

<p>In BlueFoot, the majority of the content is persisted into the database using the entity-attribute-value (EAV) format, which means the content is not available in the JSON from <code class="highlighter-rouge">$itemData</code>.</p>

<p>Some content types do not persist content to the database, such as the row and column. However for all content types that require it, you must define a virtual type declaring which EAV attributes should be loaded for the content type:</p>

<p><code class="highlighter-rouge">Magento\PageBuilder\Setup\DataConverter\ConfigurableEavAttributeLoader</code> which in turn implements our <code class="highlighter-rouge">EavAttributeLoaderInterface</code>.</p>

<p><strong>Example <code class="highlighter-rouge">di.xml</code> entry for EAV hydrator for Heading:</strong></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;virtualType</span> <span class="na">name=</span><span class="s">"HeadingEavAttributeLoader"</span> <span class="na">type=</span><span class="s">"Magento\PageBuilder\Setup\DataConverter\ConfigurableEavAttributeLoader"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;arguments&gt;</span>
        <span class="nt">&lt;argument</span> <span class="na">name=</span><span class="s">"additionalEavAttributes"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"title"</span> <span class="na">xsi:type=</span><span class="s">"string"</span><span class="nt">&gt;</span>title<span class="nt">&lt;/item&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"heading_type"</span> <span class="na">xsi:type=</span><span class="s">"string"</span><span class="nt">&gt;</span>heading_type<span class="nt">&lt;/item&gt;</span>
        <span class="nt">&lt;/argument&gt;</span>
    <span class="nt">&lt;/arguments&gt;</span>
<span class="nt">&lt;/virtualType&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>In this example, the EAV loader for Heading is assigned the <code class="highlighter-rouge">title</code> and <code class="highlighter-rouge">heading_type</code> attributes, this ensures the EAV attribute loader will retrieve these values within your renderer. Failing to include an attribute here will result in that attribute not being loaded.</p>

<p>We then use <a href="https://devdocs.magento.com/guides/v2.3/extension-dev-guide/depend-inj.html">dependency injection</a> to inject our virtual configurable EAV loader into the Heading renderer.</p>

<p><strong>Example <code class="highlighter-rouge">di.xml</code> entry for Heading renderer:</strong></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;type</span> <span class="na">name=</span><span class="s">"Magento\PageBuilder\Setup\DataConverter\Renderer\Heading"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;arguments&gt;</span>
        <span class="nt">&lt;argument</span> <span class="na">name=</span><span class="s">"eavAttributeLoader"</span> <span class="na">xsi:type=</span><span class="s">"object"</span><span class="nt">&gt;</span>HeadingEavAttributeLoader<span class="nt">&lt;/argument&gt;</span>
    <span class="nt">&lt;/arguments&gt;</span>
<span class="nt">&lt;/type&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The <code class="highlighter-rouge">EavAttributeLoaderInterface</code> includes a single method (<code class="highlighter-rouge">load</code>) to load the EAV data:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">function</span> <span class="n">load</span><span class="p">(</span><span class="nv">$entityId</span><span class="p">)</span> <span class="p">:</span> <span class="kt">array</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">$entityId</code></td>
      <td>String  | Number</td>
      <td>BlueFoot entity ID associated with the current content type.</td>
    </tr>
  </tbody>
</table>

<div style="table-layout:auto" class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$eavData</span> <span class="o">=</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$itemData</span><span class="p">[</span><span class="s1">'entityId'</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">eavAttributeLoader</span><span class="o">-&gt;</span><span class="nf">load</span><span class="p">(</span><span class="nv">$itemData</span><span class="p">[</span><span class="s1">'entityId'</span><span class="p">])</span> <span class="o">:</span> <span class="p">[];</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="attributes-with-sources">Attributes with sources</h4>

<p>Some BlueFoot attributes have sources for their data providing their actual values based on an ID. For instance, this is commonly used with boolean (Yes / No) values.</p>

<p>We automatically follow these references and update the values with their associated labels, meaning a boolean will return the value “Yes” or “No”.</p>

<h3 id="styleextractorinterface"><code class="highlighter-rouge">StyleExtractorInterface</code></h3>

<p>We utilise the style extractor to help with translating the simple EAV stored values of BlueFoot into our new actual inline CSS expressions. This extractor exists as aspects of this operation can be tedious and result in lots of duplicated code between content types.</p>

<p>The migration tool has a preference within it’s <code class="highlighter-rouge">di.xml</code> file that aligns our interface with the concrete implementation. We import this dependency through our constructor using <code class="highlighter-rouge">Magento\PageBuilder\Setup\DataConverter\StyleExtractorInterface</code>.</p>

<h4 id="extracting-styles">Extracting Styles</h4>

<p>The first method we provide is to help to extract styles and generate the associated CSS string from BlueFoot EAV or form data.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">function</span> <span class="n">extractStyle</span><span class="p">(</span><span class="kt">array</span> <span class="nv">$formData</span><span class="p">,</span> <span class="kt">array</span> <span class="nv">$defaults</span> <span class="o">=</span> <span class="p">[],</span> <span class="kt">array</span> <span class="nv">$pluck</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">:</span> <span class="kt">string</span><span class="p">;</span> 
</pre></td></tr></tbody></table></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">$formData</code></td>
      <td>Array</td>
      <td>Associative array of data from a BlueFoot block. This could be either the EAV data, the form data, or a combination of both.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">$defaults</code></td>
      <td>Array</td>
      <td>Associative array of default values which should be generated alongside the <code class="highlighter-rouge">$formData</code>. Existing values in the form data override any default values provided in this argument.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">$pluck</code></td>
      <td>Array</td>
      <td>Array of style keys to pluck from the generated styles. For example, <code class="highlighter-rouge">['text-align', 'border-color']</code> would provide just those two styles even if other styles were generated.</td>
    </tr>
  </tbody>
</table>

<p style="table-layout:auto">Even if you do not have any <code class="highlighter-rouge">$formData</code>, you must still run the <code class="highlighter-rouge">extractStyle</code> method on an empty array to ensure we apply the correct default styles to the content type. Default styles are important because they can drastically change the final appearance of the content type on the storefront and result in missing data in the admin.</p>

<p><strong>Usage:</strong></p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">styleExtractor</span><span class="o">-&gt;</span><span class="nf">extractStyle</span><span class="p">(</span><span class="nv">$formData</span><span class="p">,</span> <span class="p">[</span><span class="s1">'margin'</span> <span class="o">=&gt;</span> <span class="s1">'10px'</span><span class="p">],</span> <span class="p">[</span><span class="s1">'margin'</span><span class="p">]);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="creating-a-style-string-from-an-array">Creating a style string from an array</h4>

<p>There may be cases where you need to apply new styles to an element manually, without first extracting styles that don’t exist using the <code class="highlighter-rouge">extractStyle</code>. In these cases, use the <code class="highlighter-rouge">createStyleFromArray</code> function:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">function</span> <span class="n">createStyleFromArray</span><span class="p">(</span><span class="kt">array</span> <span class="nv">$styles</span><span class="p">)</span> <span class="p">:</span> <span class="kt">string</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">$styles</code></td>
      <td>Array</td>
      <td>Associative array of styles to be converted into a string. For example, <code class="highlighter-rouge">['border-style': 'none']</code> results in <code class="highlighter-rouge">border-style: none;</code>.</td>
    </tr>
  </tbody>
</table>

<p style="table-layout:auto">This method helps ensure continuity between content types and their styles.</p>

<h3 id="children-content-blocks">Children content blocks</h3>

<p>Some BlueFoot content types, such as the slider, can contain special child content types. Page Builder handles this differently. In Page Builder, all children are dealt with the same. In BlueFoot, these special children are stored in specific parts of the JSON data. For these particular instances, you will need to define a custom extractor for children to ensure that the migration module traverses the tree as expected.</p>

<p>For structural content types such as rows and columns a custom children extractor is not required as they will use the default.</p>

<p>During rendering, content types are processed from the bottom of the tree to the top. In other words, the system renders all child blocks first and makes the results available to the immediate parent for placement.</p>

<p>Using a virtual type of <code class="highlighter-rouge">Magento\PageBuilder\Setup\DataConverter\ChildrenExtractor\Configurable</code> we can define the path to which the child items are located within the BlueFoot data.</p>

<p><strong>Example <code class="highlighter-rouge">di.xml</code> entry:</strong></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;virtualType</span> <span class="na">name=</span><span class="s">"ButtonsChildrenExtractor"</span> <span class="na">type=</span><span class="s">"Magento\PageBuilder\Setup\DataConverter\ChildrenExtractor\Configurable"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;arguments&gt;</span>
        <span class="nt">&lt;argument</span> <span class="na">name=</span><span class="s">"path"</span> <span class="na">xsi:type=</span><span class="s">"string"</span><span class="nt">&gt;</span>children/button_items<span class="nt">&lt;/argument&gt;</span>
    <span class="nt">&lt;/arguments&gt;</span>
<span class="nt">&lt;/virtualType&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>After the system renders the child blocks, the content is available to the parent renderer through <code class="highlighter-rouge">$additionalData['children']</code> as a string. If the content type has no children this array item will not be set, so you should validate first before attempting to use it.</p>

<p>All children extractors must implement <code class="highlighter-rouge">Magento\PageBuilder\Setup\DataConverter\ChildrenExtractorInterface</code>; the path should be provided using <code class="highlighter-rouge">di.xml</code> into the constructor, the extractor for children provides a single method (<code class="highlighter-rouge">extract</code>) for retrieving the defined children:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">function</span> <span class="n">extract</span><span class="p">(</span><span class="kt">array</span> <span class="nv">$data</span><span class="p">)</span> <span class="p">:</span> <span class="kt">array</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">$data</code></td>
      <td>Array</td>
      <td>The BlueFoot content types structured data.</td>
    </tr>
  </tbody>
</table>

<p style="table-layout:auto">This function is called internally when traversing the BlueFoot structure and should not be called within individual renderers.</p>

<h3 id="renderer-pool">Renderer Pool</h3>

<p>The <code class="highlighter-rouge">di.xml</code> file declares which content type renderers are available in the renderer pool. The core PageBuilder module implements content type renderers for all its core content types.</p>

<p><strong>Example di.xml file:</strong></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;type</span> <span class="na">name=</span><span class="s">"Magento\PageBuilder\Setup\DataConverter\RendererPool"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;arguments&gt;</span>
        <span class="nt">&lt;argument</span> <span class="na">name=</span><span class="s">"renderers"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"row"</span> <span class="na">xsi:type=</span><span class="s">"object"</span><span class="nt">&gt;</span>Magento\PageBuilder\Setup\DataConverter\Renderer\Row<span class="nt">&lt;/item&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"column"</span> <span class="na">xsi:type=</span><span class="s">"object"</span><span class="nt">&gt;</span>Magento\PageBuilder\Setup\DataConverter\Renderer\Column<span class="nt">&lt;/item&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"heading"</span> <span class="na">xsi:type=</span><span class="s">"object"</span><span class="nt">&gt;</span>Magento\PageBuilder\Setup\DataConverter\Renderer\Heading<span class="nt">&lt;/item&gt;</span>
            ....
        <span class="nt">&lt;/argument&gt;</span>
    <span class="nt">&lt;/arguments&gt;</span>
<span class="nt">&lt;/type&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>If you are creating a new renderer for migration outside the PageBuilder module, you only need to list your custom renderer in the <code class="highlighter-rouge">renderers</code> array in your <code class="highlighter-rouge">di.xml</code> file.</p>

<h2 id="custom-content-types">Custom Content Types</h2>

<p>You can create a custom content type renderer as we’ve displayed here by following our article : <a href="/devdocs/2.1/page-builder-migration/docs/migrate-content-custom-blocks.html">Migrate custom content types</a>.</p>

			
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

  
  <div class="page-updated">
    <img src="/devdocs/2.1/i/icons/time.svg" alt="Updated" />
    <time id="last-modified-at" itemprop="dateModified" datetime="2019-09-10">
      Sep 10th, 2019
    </time>
  </div>
  

  


  

    

    

  

</div>


	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->


	</div>
	<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      

<ul class="nav footer-links" role="menu">

  <li class="" role="menuitem"><a href="https://github.com/magento/devdocs/blob/master/.github/CONTRIBUTING.md">Become a Contributor</a></li>

  <li class="" role="menuitem"><a href="https://glossary.magento.com/">Glossary</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/terms/privacy/">Privacy Policy</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/terms/">Terms of Service</a></li>

  <li class="" role="menuitem"><a href="https://magento.com/legal/licensing/">License/Trademark FAQ</a></li>

  <li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/release-notes/bk-release-notes.html">Release Notes</a></li>

  <li class="" role="menuitem"><a href="/devdocs/2.1/guides/v2.1/release-notes/packages-open-source.html">Third-Party Licenses</a></li>

</ul>

    </div>

		<div class="copyright-date">&copy; 2023 Magento. All rights reserved.</div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/devdocs/2.1/assets/js/app.min.js"></script>





<script type="text/javascript" src="/devdocs/2.1/common/js/last-modified-at.js"></script>
<script type="text/javascript" src="/devdocs/2.1/common/js/glossary-link-enhancer.js"></script>


</body>
</html>

